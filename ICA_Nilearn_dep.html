
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Independet Component Analysis with Nilearn (depressiv subjects)</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.5f77b4aec8189eecf79907ce328c390d.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Independet Component Analysis with Nilearn (healthy subjects)" href="ICA_Nilearn_healthy.html" />
    <link rel="prev" title="Data analyses" href="data_analyses.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="index.html">
   About the content of this Jupyter Book
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="overview.html">
   Overview &amp; motivation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="project.html">
   Project outline &amp; management plan
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data.html">
   Dataset &amp; management plan
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="lab_notebook.html">
   Lab notebook
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="lab_notebook_Grolms.html">
     Lab Notebook Grolms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lab_notebook_Thielmann.html">
     Lab Notebook Thielmann
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="data_analyses.html">
   Data analyses
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Independet Component Analysis with Nilearn (depressiv subjects)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ICA_Nilearn_healthy.html">
     Independet Component Analysis with Nilearn (healthy subjects)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="results.html">
   Results &amp; outcomes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="poster_manuscript.html">
   Poster &amp; manuscript
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data_access.html">
   Data access
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="CoC.html">
   GORELLA Code of Conduct
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Literature.html">
   References
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/ICA_Nilearn_dep.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/G0RELLA/gorella_project_template"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/G0RELLA/gorella_project_template/issues/new?title=Issue%20on%20page%20%2FICA_Nilearn_dep.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/G0RELLA/gorella_project_template/edit/master/lecture/ICA_Nilearn_dep.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/G0RELLA/gorella_project_template/master?urlpath=tree/lecture/ICA_Nilearn_dep.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-import">
   Data import
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#run-ica">
   Run ICA
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ica-plotting">
   ICA plotting
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#region-extraction">
   Region extraction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#timeseries-extraction">
   Timeseries extraction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#atlas-import">
   Atlas import
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#correlation-matrices-and-connectomes">
   Correlation matrices and connectomes
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="independet-component-analysis-with-nilearn-depressiv-subjects">
<h1>Independet Component Analysis with Nilearn (depressiv subjects)<a class="headerlink" href="#independet-component-analysis-with-nilearn-depressiv-subjects" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nilearn.decomposition</span> <span class="kn">import</span> <span class="n">CanICA</span>
<span class="kn">from</span> <span class="nn">nilearn.plotting</span> <span class="kn">import</span> <span class="n">plot_prob_atlas</span>
<span class="kn">from</span> <span class="nn">nilearn.image</span> <span class="kn">import</span> <span class="n">iter_img</span>
<span class="kn">from</span> <span class="nn">nilearn.plotting</span> <span class="kn">import</span> <span class="n">plot_stat_map</span><span class="p">,</span> <span class="n">show</span><span class="p">,</span> <span class="n">plot_prob_atlas</span><span class="p">,</span> <span class="n">plot_matrix</span><span class="p">,</span> <span class="n">plot_connectome</span><span class="p">,</span> <span class="n">find_probabilistic_atlas_cut_coords</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/jt/.local/lib/python3.8/site-packages/nilearn/datasets/__init__.py:86: FutureWarning: Fetchers from the nilearn.datasets module will be updated in version 0.9 to return python strings instead of bytes and Pandas dataframes instead of Numpy arrays.
  warn(&quot;Fetchers from the nilearn.datasets module will be &quot;
</pre></div>
</div>
</div>
</div>
<div class="section" id="data-import">
<h2>Data import<a class="headerlink" href="#data-import" title="Permalink to this headline">¶</a></h2>
<p>We are working with 2 different datasets, so we created a list with the corresponding files. We exluded 3 subjects, subject 17, 39 and 48 because of to much movement or artefacts.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">files_list</span><span class="o">=</span><span class="p">[]</span>
<span class="n">all_list</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">73</span><span class="p">))</span>
<span class="n">healthy_list</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">52</span><span class="p">,</span><span class="mi">73</span><span class="p">))</span>
<span class="n">dep_list</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">52</span><span class="p">))</span>
<span class="n">exclution_list</span><span class="o">=</span><span class="p">[</span><span class="mi">17</span><span class="p">,</span><span class="mi">39</span><span class="p">,</span><span class="mi">48</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dep_list</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclution_list</span><span class="p">:</span>
        <span class="n">j</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{:02d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">files_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;/media/jt/Daten1/preproc/datasink/smooth/sub-&quot;</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="s2">&quot;/task-restingstatewithclosedeyes/fwhm-8_swarsub-&quot;</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="s2">&quot;_task-rest_bold.nii&quot;</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
</div>
<p>Checking the subject list if everything worked well. In this case we are working with the depressiv group.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">files_list</span><span class="p">:</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/media/jt/Daten1/preproc/datasink/smooth/sub-01/task-restingstatewithclosedeyes/fwhm-8_swarsub-01_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-02/task-restingstatewithclosedeyes/fwhm-8_swarsub-02_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-03/task-restingstatewithclosedeyes/fwhm-8_swarsub-03_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-04/task-restingstatewithclosedeyes/fwhm-8_swarsub-04_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-05/task-restingstatewithclosedeyes/fwhm-8_swarsub-05_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-06/task-restingstatewithclosedeyes/fwhm-8_swarsub-06_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-07/task-restingstatewithclosedeyes/fwhm-8_swarsub-07_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-08/task-restingstatewithclosedeyes/fwhm-8_swarsub-08_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-09/task-restingstatewithclosedeyes/fwhm-8_swarsub-09_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-10/task-restingstatewithclosedeyes/fwhm-8_swarsub-10_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-11/task-restingstatewithclosedeyes/fwhm-8_swarsub-11_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-12/task-restingstatewithclosedeyes/fwhm-8_swarsub-12_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-13/task-restingstatewithclosedeyes/fwhm-8_swarsub-13_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-14/task-restingstatewithclosedeyes/fwhm-8_swarsub-14_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-15/task-restingstatewithclosedeyes/fwhm-8_swarsub-15_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-16/task-restingstatewithclosedeyes/fwhm-8_swarsub-16_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-18/task-restingstatewithclosedeyes/fwhm-8_swarsub-18_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-19/task-restingstatewithclosedeyes/fwhm-8_swarsub-19_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-20/task-restingstatewithclosedeyes/fwhm-8_swarsub-20_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-21/task-restingstatewithclosedeyes/fwhm-8_swarsub-21_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-22/task-restingstatewithclosedeyes/fwhm-8_swarsub-22_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-23/task-restingstatewithclosedeyes/fwhm-8_swarsub-23_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-24/task-restingstatewithclosedeyes/fwhm-8_swarsub-24_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-25/task-restingstatewithclosedeyes/fwhm-8_swarsub-25_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-26/task-restingstatewithclosedeyes/fwhm-8_swarsub-26_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-27/task-restingstatewithclosedeyes/fwhm-8_swarsub-27_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-28/task-restingstatewithclosedeyes/fwhm-8_swarsub-28_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-29/task-restingstatewithclosedeyes/fwhm-8_swarsub-29_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-30/task-restingstatewithclosedeyes/fwhm-8_swarsub-30_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-31/task-restingstatewithclosedeyes/fwhm-8_swarsub-31_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-32/task-restingstatewithclosedeyes/fwhm-8_swarsub-32_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-33/task-restingstatewithclosedeyes/fwhm-8_swarsub-33_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-34/task-restingstatewithclosedeyes/fwhm-8_swarsub-34_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-35/task-restingstatewithclosedeyes/fwhm-8_swarsub-35_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-36/task-restingstatewithclosedeyes/fwhm-8_swarsub-36_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-37/task-restingstatewithclosedeyes/fwhm-8_swarsub-37_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-38/task-restingstatewithclosedeyes/fwhm-8_swarsub-38_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-40/task-restingstatewithclosedeyes/fwhm-8_swarsub-40_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-41/task-restingstatewithclosedeyes/fwhm-8_swarsub-41_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-42/task-restingstatewithclosedeyes/fwhm-8_swarsub-42_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-43/task-restingstatewithclosedeyes/fwhm-8_swarsub-43_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-44/task-restingstatewithclosedeyes/fwhm-8_swarsub-44_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-45/task-restingstatewithclosedeyes/fwhm-8_swarsub-45_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-46/task-restingstatewithclosedeyes/fwhm-8_swarsub-46_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-47/task-restingstatewithclosedeyes/fwhm-8_swarsub-47_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-49/task-restingstatewithclosedeyes/fwhm-8_swarsub-49_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-50/task-restingstatewithclosedeyes/fwhm-8_swarsub-50_task-rest_bold.nii
/media/jt/Daten1/preproc/datasink/smooth/sub-51/task-restingstatewithclosedeyes/fwhm-8_swarsub-51_task-rest_bold.nii
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="run-ica">
<h2>Run ICA<a class="headerlink" href="#run-ica" title="Permalink to this headline">¶</a></h2>
<p>Now we are running the ICA (indipendent component analysis with 20 different components. We made this twice, once with the depressiv group and once with the healthy control group.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">canica</span> <span class="o">=</span> <span class="n">CanICA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                <span class="n">memory</span><span class="o">=</span><span class="s2">&quot;/media/jt/Daten1/preproc/ICA_nilearn/nilearn_cache&quot;</span><span class="p">,</span> <span class="n">memory_level</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">verbose</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                <span class="n">smoothing_fwhm</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">mask_strategy</span><span class="o">=</span><span class="s1">&#39;template&#39;</span><span class="p">,</span>
                <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">canica</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">files_list</span><span class="p">)</span>

<span class="c1"># Retrieve the independent components in brain space. Directly</span>
<span class="c1"># accesible through attribute `components_img_`.</span>
<span class="n">canica_components_img</span> <span class="o">=</span> <span class="n">canica</span><span class="o">.</span><span class="n">components_img_</span>
<span class="c1"># components_img is a Nifti Image object, and can be saved to a file with</span>
<span class="c1"># the following line:</span>
<span class="n">canica_components_img</span><span class="o">.</span><span class="n">to_filename</span><span class="p">(</span><span class="s1">&#39;//media/jt/Daten1/preproc/ICA_nilearn/canica_resting_state_dep.nii.gz&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[MultiNiftiMasker.fit] Loading data from [/media/jt/Daten1/preproc/datasink/smooth/sub-01/task-restingstatewithclosedeyes/fwhm-8_swarsub-01_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-02/task-restingstatewithclosedeyes/fwhm-8_swarsub-02_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-03/task-restingstatewithclosedeyes/fwhm-8_swarsub-03_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-04/task-restingstatewithclosedeyes/fwhm-8_swarsub-04_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-05/task-restingstatewithclosedeyes/fwhm-8_swarsub-05_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-06/task-restingstatewithclosedeyes/fwhm-8_swarsub-06_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-07/task-restingstatewithclosedeyes/fwhm-8_swarsub-07_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-08/task-restingstatewithclosedeyes/fwhm-8_swarsub-08_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-09/task-restingstatewithclosedeyes/fwhm-8_swarsub-09_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-10/task-restingstatewithclosedeyes/fwhm-8_swarsub-10_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-11/task-restingstatewithclosedeyes/fwhm-8_swarsub-11_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-12/task-restingstatewithclosedeyes/fwhm-8_swarsub-12_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-13/task-restingstatewithclosedeyes/fwhm-8_swarsub-13_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-14/task-restingstatewithclosedeyes/fwhm-8_swarsub-14_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-15/task-restingstatewithclosedeyes/fwhm-8_swarsub-15_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-16/task-restingstatewithclosedeyes/fwhm-8_swarsub-16_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-18/task-restingstatewithclosedeyes/fwhm-8_swarsub-18_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-19/task-restingstatewithclosedeyes/fwhm-8_swarsub-19_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-20/task-restingstatewithclosedeyes/fwhm-8_swarsub-20_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-21/task-restingstatewithclosedeyes/fwhm-8_swarsub-21_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-22/task-restingstatewithclosedeyes/fwhm-8_swarsub-22_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-23/task-restingstatewithclosedeyes/fwhm-8_swarsub-23_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-24/task-restingstatewithclosedeyes/fwhm-8_swarsub-24_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-25/task-restingstatewithclosedeyes/fwhm-8_swarsub-25_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-26/task-restingstatewithclosedeyes/fwhm-8_swarsub-26_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-27/task-restingstatewithclosedeyes/fwhm-8_swarsub-27_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-28/task-restingstatewithclosedeyes/fwhm-8_swarsub-28_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-29/task-restingstatewithclosedeyes/fwhm-8_swarsub-29_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-30/task-restingstatewithclosedeyes/fwhm-8_swarsub-30_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-31/task-restingstatewithclosedeyes/fwhm-8_swarsub-31_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-32/task-restingstatewithclosedeyes/fwhm-8_swarsub-32_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-33/task-restingstatewithclosedeyes/fwhm-8_swarsub-33_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-34/task-restingstatewithclosedeyes/fwhm-8_swarsub-34_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-35/task-restingstatewithclosedeyes/fwhm-8_swarsub-35_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-36/task-restingstatewithclosedeyes/fwhm-8_swarsub-36_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-37/task-restingstatewithclosedeyes/fwhm-8_swarsub-37_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-38/task-restingstatewithclosedeyes/fwhm-8_swarsub-38_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-40/task-restingstatewithclosedeyes/fwhm-8_swarsub-40_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-41/task-restingstatewithclosedeyes/fwhm-8_swarsub-41_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-42/task-restingstatewithclosedeyes/fwhm-8_swarsub-42_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-43/task-restingstatewithclosedeyes/fwhm-8_swarsub-43_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-44/task-restingstatewithclosedeyes/fwhm-8_swarsub-44_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-45/task-restingstatewithclosedeyes/fwhm-8_swarsub-45_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-46/task-restingstatewithclosedeyes/fwhm-8_swarsub-46_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-47/task-restingstatewithclosedeyes/fwhm-8_swarsub-47_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-49/task-restingstatewithclosedeyes/fwhm-8_swarsub-49_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-50/task-restingstatewithclosedeyes/fwhm-8_swarsub-50_task-rest_bold.nii,
 /media/jt/Daten1/preproc/datasink/smooth/sub-51/task-restingstatewithclosedeyes/fwhm-8_swarsub-51_task-rest_bold.nii]
[MultiNiftiMasker.fit] Computing mask
Template mask computation
[MultiNiftiMasker.transform] Resampling mask
[CanICA] Loading data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/jt/.local/lib/python3.8/site-packages/nilearn/masking.py:627: UserWarning: Persisting input arguments took 0.71s to run.
If this happens often in your code, it can cause performance problems 
(results will be correct in all cases). 
The reason for this is probably some large input arguments for a wrapped
 function (e.g. large strings).
THIS IS A JOBLIB ISSUE. If you can, kindly provide the joblib&#39;s team with an
 example so that they can fix the problem.
  resampled_template = cache(resample_to_img, memory)(template, target_img)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>________________________________________________________________________________
[Memory] Calling sklearn.utils.extmath.randomized_svd...
randomized_svd(array([[ 0.001254, ...,  0.00049 ],
       ...,
       [ 0.00032 , ..., -0.002165]]), n_components=20, transpose=True, random_state=0, n_iter=3)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/jt/.local/lib/python3.8/site-packages/nilearn/decomposition/multi_pca.py:180: UserWarning: Persisting input arguments took 2.48s to run.
If this happens often in your code, it can cause performance problems 
(results will be correct in all cases). 
The reason for this is probably some large input arguments for a wrapped
 function (e.g. large strings).
THIS IS A JOBLIB ISSUE. If you can, kindly provide the joblib&#39;s team with an
 example so that they can fix the problem.
  components_, self.variance_, _ = self._cache(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>__________________________________________________randomized_svd - 11.6s, 0.2min
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Parallel(n_jobs=-2)]: Using backend LokyBackend with 7 concurrent workers.
[Parallel(n_jobs=-2)]: Done   3 out of  10 | elapsed:    1.2s remaining:    2.9s
[Parallel(n_jobs=-2)]: Done   5 out of  10 | elapsed:    1.4s remaining:    1.4s
[Parallel(n_jobs=-2)]: Done   7 out of  10 | elapsed:    1.6s remaining:    0.7s
[Parallel(n_jobs=-2)]: Done  10 out of  10 | elapsed:    1.8s finished
/home/jt/.local/lib/python3.8/site-packages/nilearn/image/image.py:1054: FutureWarning: The parameter &quot;sessions&quot; will be removed in 0.9.0 release of Nilearn. Please use the parameter &quot;runs&quot; instead.
  data = signal.clean(
</pre></div>
</div>
</div>
</div>
<p>In case you don’t make this whole script in one time you can start here now loading the created ICA file to continue.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Only run for plotting without processing or further processing of the ICA data without CanICA them again</span>
<span class="n">canica_components_img</span><span class="o">=</span><span class="s2">&quot;/media/jt/Daten1/preproc/ICA_nilearn/canica_resting_state_dep.nii.gz&quot;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="ica-plotting">
<h2>ICA plotting<a class="headerlink" href="#ica-plotting" title="Permalink to this headline">¶</a></h2>
<p>Here we plot the calculated components by CanICA.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot all ICA components together</span>
<span class="n">plot_prob_atlas</span><span class="p">(</span><span class="n">canica_components_img</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;All ICA components&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.8/dist-packages/numpy/ma/core.py:2825: UserWarning: Warning: converting a masked element to nan.
  _data = np.array(data, dtype=dtype, copy=copy,
/home/jt/.local/lib/python3.8/site-packages/nilearn/plotting/displays.py:101: UserWarning: No contour levels were found within the data range.
  im = getattr(ax, type)(data_2d.copy(),
/home/jt/.local/lib/python3.8/site-packages/nilearn/plotting/displays.py:101: UserWarning: linewidths is ignored by contourf
  im = getattr(ax, type)(data_2d.copy(),
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;nilearn.plotting.displays.OrthoSlicer at 0x7fde1b7b1160&gt;
</pre></div>
</div>
<img alt="_images/ICA_Nilearn_dep_14_2.png" src="_images/ICA_Nilearn_dep_14_2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#plot the different slices of components</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cur_img</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">iter_img</span><span class="p">(</span><span class="n">canica_components_img</span><span class="p">)):</span>
    <span class="n">plot_stat_map</span><span class="p">(</span><span class="n">cur_img</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;IC </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span>
                  <span class="n">cut_coords</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ICA_Nilearn_dep_15_0.png" src="_images/ICA_Nilearn_dep_15_0.png" />
<img alt="_images/ICA_Nilearn_dep_15_1.png" src="_images/ICA_Nilearn_dep_15_1.png" />
<img alt="_images/ICA_Nilearn_dep_15_2.png" src="_images/ICA_Nilearn_dep_15_2.png" />
<img alt="_images/ICA_Nilearn_dep_15_3.png" src="_images/ICA_Nilearn_dep_15_3.png" />
<img alt="_images/ICA_Nilearn_dep_15_4.png" src="_images/ICA_Nilearn_dep_15_4.png" />
<img alt="_images/ICA_Nilearn_dep_15_5.png" src="_images/ICA_Nilearn_dep_15_5.png" />
<img alt="_images/ICA_Nilearn_dep_15_6.png" src="_images/ICA_Nilearn_dep_15_6.png" />
<img alt="_images/ICA_Nilearn_dep_15_7.png" src="_images/ICA_Nilearn_dep_15_7.png" />
<img alt="_images/ICA_Nilearn_dep_15_8.png" src="_images/ICA_Nilearn_dep_15_8.png" />
<img alt="_images/ICA_Nilearn_dep_15_9.png" src="_images/ICA_Nilearn_dep_15_9.png" />
<img alt="_images/ICA_Nilearn_dep_15_10.png" src="_images/ICA_Nilearn_dep_15_10.png" />
<img alt="_images/ICA_Nilearn_dep_15_11.png" src="_images/ICA_Nilearn_dep_15_11.png" />
<img alt="_images/ICA_Nilearn_dep_15_12.png" src="_images/ICA_Nilearn_dep_15_12.png" />
<img alt="_images/ICA_Nilearn_dep_15_13.png" src="_images/ICA_Nilearn_dep_15_13.png" />
<img alt="_images/ICA_Nilearn_dep_15_14.png" src="_images/ICA_Nilearn_dep_15_14.png" />
<img alt="_images/ICA_Nilearn_dep_15_15.png" src="_images/ICA_Nilearn_dep_15_15.png" />
<img alt="_images/ICA_Nilearn_dep_15_16.png" src="_images/ICA_Nilearn_dep_15_16.png" />
<img alt="_images/ICA_Nilearn_dep_15_17.png" src="_images/ICA_Nilearn_dep_15_17.png" />
<img alt="_images/ICA_Nilearn_dep_15_18.png" src="_images/ICA_Nilearn_dep_15_18.png" />
<img alt="_images/ICA_Nilearn_dep_15_19.png" src="_images/ICA_Nilearn_dep_15_19.png" />
</div>
</div>
</div>
<div class="section" id="region-extraction">
<h2>Region extraction<a class="headerlink" href="#region-extraction" title="Permalink to this headline">¶</a></h2>
<p>Next step is to extract the different regions of the 20 components. Therefore we used the nilearn region extractor with a min region size of 2000. That corresponds to about 100 voxel (2x2x5mm voxel size).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">components_img</span><span class="o">=</span><span class="n">canica_components_img</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import Region Extractor algorithm from regions module</span>
<span class="c1"># threshold=0.5 indicates that we keep nominal of amount nonzero voxels across all</span>
<span class="c1"># maps, less the threshold means that more intense non-voxels will be survived.</span>
<span class="kn">from</span> <span class="nn">nilearn.regions</span> <span class="kn">import</span> <span class="n">RegionExtractor</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">datasets</span>

<span class="n">atlas</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_atlas_msdl</span><span class="p">()</span>
<span class="c1"># Loading atlas image stored in &#39;maps&#39;</span>
<span class="n">atlas_filename</span> <span class="o">=</span> <span class="n">atlas</span><span class="p">[</span><span class="s1">&#39;maps&#39;</span><span class="p">]</span>

<span class="n">extractor</span> <span class="o">=</span> <span class="n">RegionExtractor</span><span class="p">(</span><span class="n">components_img</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                            <span class="n">thresholding_strategy</span><span class="o">=</span><span class="s1">&#39;ratio_n_voxels&#39;</span><span class="p">,</span>
                            <span class="n">extractor</span><span class="o">=</span><span class="s1">&#39;local_regions&#39;</span><span class="p">,</span>
                            <span class="n">standardize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">min_region_size</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
<span class="c1"># Just call fit() to process for regions extraction</span>
<span class="n">extractor</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="c1"># Extracted regions are stored in regions_img_</span>
<span class="n">regions_extracted_img</span> <span class="o">=</span> <span class="n">extractor</span><span class="o">.</span><span class="n">regions_img_</span>
<span class="c1"># Each region index is stored in index_</span>
<span class="n">regions_index</span> <span class="o">=</span> <span class="n">extractor</span><span class="o">.</span><span class="n">index_</span>
<span class="c1"># Total number of regions extracted</span>
<span class="n">n_regions_extracted</span> <span class="o">=</span> <span class="n">regions_extracted_img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Visualization of region extraction results</span>
<span class="n">title</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> regions are extracted from </span><span class="si">%d</span><span class="s1"> components.&#39;</span>
         <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Each separate color of region indicates extracted region&#39;</span>
         <span class="o">%</span> <span class="p">(</span><span class="n">n_regions_extracted</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<span class="n">plot_prob_atlas</span><span class="p">(</span><span class="n">regions_extracted_img</span><span class="p">,</span> <span class="n">view_type</span><span class="o">=</span><span class="s1">&#39;filled_contours&#39;</span><span class="p">,</span>
                         <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.8/dist-packages/numpy/lib/npyio.py:2405: VisibleDeprecationWarning: Reading unicode strings without specifying the encoding argument is deprecated. Set the encoding, use None for the system default.
  output = genfromtxt(fname, **kwargs)
/home/jt/.local/lib/python3.8/site-packages/nilearn/image/image.py:1054: FutureWarning: The parameter &quot;sessions&quot; will be removed in 0.9.0 release of Nilearn. Please use the parameter &quot;runs&quot; instead.
  data = signal.clean(
/usr/local/lib/python3.8/dist-packages/numpy/ma/core.py:2825: UserWarning: Warning: converting a masked element to nan.
  _data = np.array(data, dtype=dtype, copy=copy,
/home/jt/.local/lib/python3.8/site-packages/nilearn/plotting/displays.py:101: UserWarning: No contour levels were found within the data range.
  im = getattr(ax, type)(data_2d.copy(),
/home/jt/.local/lib/python3.8/site-packages/nilearn/plotting/displays.py:101: UserWarning: linewidths is ignored by contourf
  im = getattr(ax, type)(data_2d.copy(),
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;nilearn.plotting.displays.OrthoSlicer at 0x7f1f3127b700&gt;
</pre></div>
</div>
<img alt="_images/ICA_Nilearn_dep_19_2.png" src="_images/ICA_Nilearn_dep_19_2.png" />
</div>
</div>
</div>
<div class="section" id="timeseries-extraction">
<h2>Timeseries extraction<a class="headerlink" href="#timeseries-extraction" title="Permalink to this headline">¶</a></h2>
<p>Now we are ready to extract the different timeseries of the subjects.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First we need to do subjects timeseries signals extraction and then estimating</span>
<span class="c1"># correlation matrices on those signals.</span>
<span class="c1"># To extract timeseries signals, we call transform() from RegionExtractor object</span>
<span class="c1"># onto each subject functional data stored in files_list.</span>
<span class="c1"># To estimate correlation matrices we import connectome utilities from nilearn</span>
<span class="kn">from</span> <span class="nn">nilearn.connectome</span> <span class="kn">import</span> <span class="n">ConnectivityMeasure</span>

<span class="n">correlations</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Initializing ConnectivityMeasure object with kind=&#39;correlation&#39;</span>
<span class="n">connectome_measure</span> <span class="o">=</span> <span class="n">ConnectivityMeasure</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;correlation&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">files_list</span><span class="p">:</span>
    <span class="c1"># call transform from RegionExtractor object to extract timeseries signals</span>
    <span class="n">timeseries_each_subject</span> <span class="o">=</span> <span class="n">extractor</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="c1"># call fit_transform from ConnectivityMeasure object</span>
    <span class="n">correlation</span> <span class="o">=</span> <span class="n">connectome_measure</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">([</span><span class="n">timeseries_each_subject</span><span class="p">])</span>
    <span class="c1"># saving each subject correlation to correlations</span>
    <span class="n">correlations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">correlation</span><span class="p">)</span>

<span class="c1"># Mean of all correlations</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">mean_correlations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">correlations</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_regions_extracted</span><span class="p">,</span>
                                                          <span class="n">n_regions_extracted</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="atlas-import">
<h2>Atlas import<a class="headerlink" href="#atlas-import" title="Permalink to this headline">¶</a></h2>
<p>Importing the atlas for labeling the matrices later.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">image</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">input_data</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="n">msdl_atlas_dataset</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_atlas_msdl</span><span class="p">()</span>

<span class="c1"># A &quot;memory&quot; to avoid recomputation</span>
<span class="kn">from</span> <span class="nn">joblib</span> <span class="kn">import</span> <span class="n">Memory</span>
<span class="n">mem</span> <span class="o">=</span> <span class="n">Memory</span><span class="p">(</span><span class="s1">&#39;nilearn_cache&#39;</span><span class="p">)</span>

<span class="n">masker</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">NiftiMapsMasker</span><span class="p">(</span>
    <span class="n">msdl_atlas_dataset</span><span class="o">.</span><span class="n">maps</span><span class="p">,</span> <span class="n">resampling_target</span><span class="o">=</span><span class="s2">&quot;maps&quot;</span><span class="p">,</span> <span class="n">detrend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">high_variance_confounds</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">low_pass</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">high_pass</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
    <span class="n">t_r</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">standardize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">memory</span><span class="o">=</span><span class="s1">&#39;nilearn_cache&#39;</span><span class="p">,</span> <span class="n">memory_level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">masker</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="n">subject_time_series</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">func_filenames</span> <span class="o">=</span> <span class="n">files_list</span>
<span class="k">for</span> <span class="n">func_filename</span> <span class="ow">in</span> <span class="p">(</span><span class="n">func_filenames</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Processing file </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">func_filename</span><span class="p">)</span>

    <span class="n">region_ts</span> <span class="o">=</span> <span class="n">masker</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">func_filename</span><span class="p">)</span>
    <span class="n">subject_time_series</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">region_ts</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.8/dist-packages/numpy/lib/npyio.py:2405: VisibleDeprecationWarning: Reading unicode strings without specifying the encoding argument is deprecated. Set the encoding, use None for the system default.
  output = genfromtxt(fname, **kwargs)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[NiftiMapsMasker.fit] loading regions from /home/jt/nilearn_data/msdl_atlas/MSDL_rois/msdl_rois.nii
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/jt/.local/lib/python3.8/site-packages/nilearn/image/image.py:1054: FutureWarning: The parameter &quot;sessions&quot; will be removed in 0.9.0 release of Nilearn. Please use the parameter &quot;runs&quot; instead.
  data = signal.clean(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-01/task-restingstatewithclosedeyes/fwhm-8_swarsub-01_task-rest_bold.nii
[Memory]0.0s, 0.0min    : Loading high_variance_confounds...
[Memory]0.1s, 0.0min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-02/task-restingstatewithclosedeyes/fwhm-8_swarsub-02_task-rest_bold.nii
[Memory]0.1s, 0.0min    : Loading high_variance_confounds...
[Memory]0.1s, 0.0min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-03/task-restingstatewithclosedeyes/fwhm-8_swarsub-03_task-rest_bold.nii
[Memory]0.1s, 0.0min    : Loading high_variance_confounds...
[Memory]0.2s, 0.0min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-04/task-restingstatewithclosedeyes/fwhm-8_swarsub-04_task-rest_bold.nii
[Memory]0.2s, 0.0min    : Loading high_variance_confounds...
[Memory]0.2s, 0.0min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-05/task-restingstatewithclosedeyes/fwhm-8_swarsub-05_task-rest_bold.nii
[Memory]0.2s, 0.0min    : Loading high_variance_confounds...
[Memory]0.3s, 0.0min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-06/task-restingstatewithclosedeyes/fwhm-8_swarsub-06_task-rest_bold.nii
[Memory]0.3s, 0.0min    : Loading high_variance_confounds...
[Memory]0.3s, 0.0min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-07/task-restingstatewithclosedeyes/fwhm-8_swarsub-07_task-rest_bold.nii
[Memory]0.3s, 0.0min    : Loading high_variance_confounds...
[Memory]0.3s, 0.0min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-08/task-restingstatewithclosedeyes/fwhm-8_swarsub-08_task-rest_bold.nii
[Memory]0.3s, 0.0min    : Loading high_variance_confounds...
________________________________________________________________________________
[Memory] Calling nilearn.input_data.base_masker.filter_and_extract...
filter_and_extract(&#39;/media/jt/Daten1/preproc/datasink/smooth/sub-08/task-restingstatewithclosedeyes/fwhm-8_swarsub-08_task-rest_bold.nii&#39;, 
&lt;nilearn.input_data.nifti_maps_masker._ExtractionFunctor object at 0x7f1f30427f70&gt;, 
{ &#39;allow_overlap&#39;: True,
  &#39;detrend&#39;: True,
  &#39;dtype&#39;: None,
  &#39;high_pass&#39;: 0.01,
  &#39;high_variance_confounds&#39;: True,
  &#39;low_pass&#39;: None,
  &#39;maps_img&#39;: &#39;/home/jt/nilearn_data/msdl_atlas/MSDL_rois/msdl_rois.nii&#39;,
  &#39;mask_img&#39;: None,
  &#39;smoothing_fwhm&#39;: None,
  &#39;standardize&#39;: True,
  &#39;standardize_confounds&#39;: True,
  &#39;t_r&#39;: 2,
  &#39;target_affine&#39;: array([[   4.,    0.,    0.,  -78.],
       [   0.,    4.,    0., -111.],
       [   0.,    0.,    4.,  -51.],
       [   0.,    0.,    0.,    1.]]),
  &#39;target_shape&#39;: (40, 48, 35)}, confounds=[ array([[-0.09913 , ...,  0.10154 ],
       ...,
       [ 0.05749 , ..., -0.089969]])], sample_mask=None, dtype=None, memory=Memory(location=nilearn_cache/joblib), memory_level=1, verbose=2)
[NiftiMapsMasker.transform_single_imgs] Loading data from /media/jt/Daten1/preproc/datasink/smooth/sub-08/task-restingstatewithclosedeyes/fwhm-8_swarsub-08_task-rest_bold.nii
[NiftiMapsMasker.transform_single_imgs] Resampling images
[NiftiMapsMasker.transform_single_imgs] Extracting region signals
[NiftiMapsMasker.transform_single_imgs] Cleaning extracted signals
_______________________________________________filter_and_extract - 6.9s, 0.1min
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-09/task-restingstatewithclosedeyes/fwhm-8_swarsub-09_task-rest_bold.nii
[Memory]7.4s, 0.1min    : Loading high_variance_confounds...
[Memory]7.5s, 0.1min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-10/task-restingstatewithclosedeyes/fwhm-8_swarsub-10_task-rest_bold.nii
[Memory]7.5s, 0.1min    : Loading high_variance_confounds...
[Memory]7.6s, 0.1min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-11/task-restingstatewithclosedeyes/fwhm-8_swarsub-11_task-rest_bold.nii
[Memory]7.6s, 0.1min    : Loading high_variance_confounds...
[Memory]7.7s, 0.1min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-12/task-restingstatewithclosedeyes/fwhm-8_swarsub-12_task-rest_bold.nii
[Memory]7.7s, 0.1min    : Loading high_variance_confounds...
[Memory]7.7s, 0.1min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-13/task-restingstatewithclosedeyes/fwhm-8_swarsub-13_task-rest_bold.nii
[Memory]7.7s, 0.1min    : Loading high_variance_confounds...
[Memory]7.8s, 0.1min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-14/task-restingstatewithclosedeyes/fwhm-8_swarsub-14_task-rest_bold.nii
[Memory]7.8s, 0.1min    : Loading high_variance_confounds...
[Memory]7.9s, 0.1min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-15/task-restingstatewithclosedeyes/fwhm-8_swarsub-15_task-rest_bold.nii
[Memory]7.9s, 0.1min    : Loading high_variance_confounds...
[Memory]8.0s, 0.1min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-16/task-restingstatewithclosedeyes/fwhm-8_swarsub-16_task-rest_bold.nii
[Memory]8.0s, 0.1min    : Loading high_variance_confounds...
[Memory]8.0s, 0.1min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-18/task-restingstatewithclosedeyes/fwhm-8_swarsub-18_task-rest_bold.nii
[Memory]8.0s, 0.1min    : Loading high_variance_confounds...
[Memory]8.1s, 0.1min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-19/task-restingstatewithclosedeyes/fwhm-8_swarsub-19_task-rest_bold.nii
[Memory]8.1s, 0.1min    : Loading high_variance_confounds...
[Memory]8.2s, 0.1min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-20/task-restingstatewithclosedeyes/fwhm-8_swarsub-20_task-rest_bold.nii
[Memory]8.2s, 0.1min    : Loading high_variance_confounds...
[Memory]8.3s, 0.1min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-21/task-restingstatewithclosedeyes/fwhm-8_swarsub-21_task-rest_bold.nii
[Memory]8.3s, 0.1min    : Loading high_variance_confounds...
[Memory]8.4s, 0.1min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-22/task-restingstatewithclosedeyes/fwhm-8_swarsub-22_task-rest_bold.nii
[Memory]8.4s, 0.1min    : Loading high_variance_confounds...
[Memory]8.4s, 0.1min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-23/task-restingstatewithclosedeyes/fwhm-8_swarsub-23_task-rest_bold.nii
[Memory]8.4s, 0.1min    : Loading high_variance_confounds...
[Memory]8.5s, 0.1min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-24/task-restingstatewithclosedeyes/fwhm-8_swarsub-24_task-rest_bold.nii
[Memory]8.5s, 0.1min    : Loading high_variance_confounds...
[Memory]8.6s, 0.1min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-25/task-restingstatewithclosedeyes/fwhm-8_swarsub-25_task-rest_bold.nii
[Memory]8.6s, 0.1min    : Loading high_variance_confounds...
[Memory]8.7s, 0.1min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-26/task-restingstatewithclosedeyes/fwhm-8_swarsub-26_task-rest_bold.nii
[Memory]8.7s, 0.1min    : Loading high_variance_confounds...
[Memory]8.7s, 0.1min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-27/task-restingstatewithclosedeyes/fwhm-8_swarsub-27_task-rest_bold.nii
[Memory]8.7s, 0.1min    : Loading high_variance_confounds...
[Memory]8.8s, 0.1min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-28/task-restingstatewithclosedeyes/fwhm-8_swarsub-28_task-rest_bold.nii
[Memory]8.8s, 0.1min    : Loading high_variance_confounds...
[Memory]8.9s, 0.1min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-29/task-restingstatewithclosedeyes/fwhm-8_swarsub-29_task-rest_bold.nii
[Memory]8.9s, 0.1min    : Loading high_variance_confounds...
[Memory]9.0s, 0.1min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-30/task-restingstatewithclosedeyes/fwhm-8_swarsub-30_task-rest_bold.nii
[Memory]9.0s, 0.1min    : Loading high_variance_confounds...
[Memory]9.0s, 0.2min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-31/task-restingstatewithclosedeyes/fwhm-8_swarsub-31_task-rest_bold.nii
[Memory]9.0s, 0.2min    : Loading high_variance_confounds...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Memory]9.1s, 0.2min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-32/task-restingstatewithclosedeyes/fwhm-8_swarsub-32_task-rest_bold.nii
[Memory]9.1s, 0.2min    : Loading high_variance_confounds...
[Memory]9.2s, 0.2min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-33/task-restingstatewithclosedeyes/fwhm-8_swarsub-33_task-rest_bold.nii
[Memory]9.2s, 0.2min    : Loading high_variance_confounds...
[Memory]9.3s, 0.2min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-34/task-restingstatewithclosedeyes/fwhm-8_swarsub-34_task-rest_bold.nii
[Memory]9.3s, 0.2min    : Loading high_variance_confounds...
[Memory]9.3s, 0.2min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-35/task-restingstatewithclosedeyes/fwhm-8_swarsub-35_task-rest_bold.nii
[Memory]9.3s, 0.2min    : Loading high_variance_confounds...
[Memory]9.4s, 0.2min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-36/task-restingstatewithclosedeyes/fwhm-8_swarsub-36_task-rest_bold.nii
[Memory]9.4s, 0.2min    : Loading high_variance_confounds...
[Memory]9.5s, 0.2min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-37/task-restingstatewithclosedeyes/fwhm-8_swarsub-37_task-rest_bold.nii
[Memory]9.5s, 0.2min    : Loading high_variance_confounds...
[Memory]9.6s, 0.2min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-38/task-restingstatewithclosedeyes/fwhm-8_swarsub-38_task-rest_bold.nii
[Memory]9.6s, 0.2min    : Loading high_variance_confounds...
[Memory]9.6s, 0.2min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-40/task-restingstatewithclosedeyes/fwhm-8_swarsub-40_task-rest_bold.nii
[Memory]9.6s, 0.2min    : Loading high_variance_confounds...
[Memory]9.7s, 0.2min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-41/task-restingstatewithclosedeyes/fwhm-8_swarsub-41_task-rest_bold.nii
[Memory]9.7s, 0.2min    : Loading high_variance_confounds...
[Memory]9.8s, 0.2min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-42/task-restingstatewithclosedeyes/fwhm-8_swarsub-42_task-rest_bold.nii
[Memory]9.8s, 0.2min    : Loading high_variance_confounds...
[Memory]9.9s, 0.2min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-43/task-restingstatewithclosedeyes/fwhm-8_swarsub-43_task-rest_bold.nii
[Memory]9.9s, 0.2min    : Loading high_variance_confounds...
[Memory]9.9s, 0.2min    : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-44/task-restingstatewithclosedeyes/fwhm-8_swarsub-44_task-rest_bold.nii
[Memory]9.9s, 0.2min    : Loading high_variance_confounds...
[Memory]10.0s, 0.2min   : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-45/task-restingstatewithclosedeyes/fwhm-8_swarsub-45_task-rest_bold.nii
[Memory]10.0s, 0.2min   : Loading high_variance_confounds...
[Memory]10.1s, 0.2min   : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-46/task-restingstatewithclosedeyes/fwhm-8_swarsub-46_task-rest_bold.nii
[Memory]10.1s, 0.2min   : Loading high_variance_confounds...
[Memory]10.2s, 0.2min   : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-47/task-restingstatewithclosedeyes/fwhm-8_swarsub-47_task-rest_bold.nii
[Memory]10.2s, 0.2min   : Loading high_variance_confounds...
[Memory]10.2s, 0.2min   : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-49/task-restingstatewithclosedeyes/fwhm-8_swarsub-49_task-rest_bold.nii
[Memory]10.2s, 0.2min   : Loading high_variance_confounds...
[Memory]10.3s, 0.2min   : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-50/task-restingstatewithclosedeyes/fwhm-8_swarsub-50_task-rest_bold.nii
[Memory]10.3s, 0.2min   : Loading high_variance_confounds...
[Memory]10.4s, 0.2min   : Loading filter_and_extract...
Processing file /media/jt/Daten1/preproc/datasink/smooth/sub-51/task-restingstatewithclosedeyes/fwhm-8_swarsub-51_task-rest_bold.nii
[Memory]10.4s, 0.2min   : Loading high_variance_confounds...
[Memory]10.5s, 0.2min   : Loading filter_and_extract...
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="correlation-matrices-and-connectomes">
<h2>Correlation matrices and connectomes<a class="headerlink" href="#correlation-matrices-and-connectomes" title="Permalink to this headline">¶</a></h2>
<p>We use two different ways to compute the precision and correlation, GraphicalLassoCV and GroupSparseCovarianceCV.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nilearn.connectome</span> <span class="kn">import</span> <span class="n">GroupSparseCovarianceCV</span>
<span class="n">gsc</span> <span class="o">=</span> <span class="n">GroupSparseCovarianceCV</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">gsc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">subject_time_series</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">sklearn.covariance</span> <span class="kn">import</span> <span class="n">GraphicalLassoCV</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="c1"># for Scitkit-Learn &lt; v0.20.0</span>
    <span class="kn">from</span> <span class="nn">sklearn.covariance</span> <span class="kn">import</span> <span class="n">GraphLassoCV</span> <span class="k">as</span> <span class="n">GraphicalLassoCV</span>

<span class="n">gl</span> <span class="o">=</span> <span class="n">GraphicalLassoCV</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">gl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">subject_time_series</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 5
[GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:    9.1s remaining:    0.0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 1
[GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
[GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 5
[GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
[GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 5
[GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 11
[GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
[GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 5
[GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 16
[GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
[GroupSparseCovarianceCV.fit] [GroupSparseCovarianceCV] Done refinement  1 out of 4
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Parallel(n_jobs=1)]: Done   5 out of   5 | elapsed:   49.7s finished
[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 9
[GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:   16.9s remaining:    0.0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 7
[GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
[GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 8
[GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
[GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
[GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 8
[GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
[GroupSparseCovarianceCV.fit] [GroupSparseCovarianceCV] Done refinement  2 out of 4
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Parallel(n_jobs=1)]: Done   5 out of   5 | elapsed:  1.4min finished
[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 10
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:   17.1s remaining:    0.0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 8
[GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 9
[GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 9
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Parallel(n_jobs=1)]: Done   5 out of   5 | elapsed:  1.3min finished
[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[GroupSparseCovarianceCV.fit] [GroupSparseCovarianceCV] Done refinement  3 out of 4
[GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 14
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:   16.2s remaining:    0.0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 12
[GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 6
[GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 6
[GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 7
[GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 13
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Parallel(n_jobs=1)]: Done   5 out of   5 | elapsed:  1.2min finished
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[GroupSparseCovarianceCV.fit] [GroupSparseCovarianceCV] Done refinement  4 out of 4
[GroupSparseCovarianceCV.fit] Final optimization
[GroupSparseCovarianceCV.fit] tolerance reached at iteration number 27: 8.554e-04
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
....[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:    0.5s remaining:    0.0s
................[Parallel(n_jobs=1)]: Done   5 out of   5 | elapsed:    2.3s finished
[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[GraphicalLassoCV] Done refinement  1 out of 4:   2s
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>...[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:    0.6s remaining:    0.0s
................[Parallel(n_jobs=1)]: Done   5 out of   5 | elapsed:    2.4s finished
[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[GraphicalLassoCV] Done refinement  2 out of 4:   4s
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>....[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:    0.5s remaining:    0.0s
................[Parallel(n_jobs=1)]: Done   5 out of   5 | elapsed:    2.2s finished
[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[GraphicalLassoCV] Done refinement  3 out of 4:   6s
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>....[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:    0.6s remaining:    0.0s
................[Parallel(n_jobs=1)]: Done   5 out of   5 | elapsed:    2.4s finished
[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
[Parallel(n_jobs=1)]: Done   5 out of   5 | elapsed:    0.0s finished
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[GraphicalLassoCV] Done refinement  4 out of 4:   9s
[graphical_lasso] Iteration   0, cost  1.64e+02, dual gap 5.350e-02
[graphical_lasso] Iteration   1, cost  1.64e+02, dual gap -5.185e-03
[graphical_lasso] Iteration   2, cost  1.64e+02, dual gap -1.237e-04
[graphical_lasso] Iteration   3, cost  1.64e+02, dual gap -2.600e-04
[graphical_lasso] Iteration   4, cost  1.64e+02, dual gap -6.945e-04
[graphical_lasso] Iteration   5, cost  1.64e+02, dual gap -1.485e-04
[graphical_lasso] Iteration   6, cost  1.64e+02, dual gap -1.237e-04
[graphical_lasso] Iteration   7, cost  1.64e+02, dual gap -4.181e-05
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GraphicalLassoCV(verbose=2)
</pre></div>
</div>
</div>
</div>
<p>Define a function to plot the matrices easier.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">plotting</span>

<span class="k">def</span> <span class="nf">plot_matrices</span><span class="p">(</span><span class="n">cov</span><span class="p">,</span> <span class="n">prec</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plot covariance and precision matrices, for a given processing. &quot;&quot;&quot;</span>

    <span class="n">prec</span> <span class="o">=</span> <span class="n">prec</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>  <span class="c1"># avoid side effects</span>

    <span class="c1"># Put zeros on the diagonal, for graph clarity.</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">prec</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">prec</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">)),</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">))]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">span</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">prec</span><span class="o">.</span><span class="n">min</span><span class="p">()),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">prec</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>

    <span class="c1"># Display covariance matrix</span>
    <span class="n">plotting</span><span class="o">.</span><span class="n">plot_matrix</span><span class="p">(</span><span class="n">cov</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plotting</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">bwr</span><span class="p">,</span>
                         <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> / covariance&quot;</span> <span class="o">%</span> <span class="n">title</span><span class="p">,</span>
                         <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
    <span class="c1"># Display precision matrix</span>
    <span class="n">plotting</span><span class="o">.</span><span class="n">plot_matrix</span><span class="p">(</span><span class="n">prec</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plotting</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">bwr</span><span class="p">,</span>
                         <span class="n">vmin</span><span class="o">=-</span><span class="n">span</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">span</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> / precision&quot;</span> <span class="o">%</span> <span class="n">title</span><span class="p">,</span>
                         <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Plotting the connectomes and matrices.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">atlas_img</span> <span class="o">=</span> <span class="n">msdl_atlas_dataset</span><span class="o">.</span><span class="n">maps</span>
<span class="n">atlas_region_coords</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">find_probabilistic_atlas_cut_coords</span><span class="p">(</span><span class="n">atlas_img</span><span class="p">)</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">msdl_atlas_dataset</span><span class="o">.</span><span class="n">labels</span>

<span class="n">plotting</span><span class="o">.</span><span class="n">plot_connectome</span><span class="p">(</span><span class="n">gl</span><span class="o">.</span><span class="n">covariance_</span><span class="p">,</span>
                         <span class="n">atlas_region_coords</span><span class="p">,</span> <span class="n">edge_threshold</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">,</span>
                         <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Covariance&quot;</span><span class="p">,</span>
                         <span class="n">display_mode</span><span class="o">=</span><span class="s2">&quot;lzr&quot;</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_connectome</span><span class="p">(</span><span class="o">-</span><span class="n">gl</span><span class="o">.</span><span class="n">precision_</span><span class="p">,</span> <span class="n">atlas_region_coords</span><span class="p">,</span>
                         <span class="n">edge_threshold</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">,</span>
                         <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Sparse inverse covariance (GraphicalLasso)&quot;</span><span class="p">,</span>
                         <span class="n">display_mode</span><span class="o">=</span><span class="s2">&quot;lzr&quot;</span><span class="p">,</span>
                         <span class="n">edge_vmax</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">edge_vmin</span><span class="o">=-</span><span class="mf">.5</span><span class="p">)</span>
<span class="n">plot_matrices</span><span class="p">(</span><span class="n">gl</span><span class="o">.</span><span class="n">covariance_</span><span class="p">,</span> <span class="n">gl</span><span class="o">.</span><span class="n">precision_</span><span class="p">,</span> <span class="s2">&quot;GraphicalLasso&quot;</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>

<span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;GroupSparseCovariance&quot;</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_connectome</span><span class="p">(</span><span class="o">-</span><span class="n">gsc</span><span class="o">.</span><span class="n">precisions_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                         <span class="n">atlas_region_coords</span><span class="p">,</span> <span class="n">edge_threshold</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">,</span>
                         <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
                         <span class="n">display_mode</span><span class="o">=</span><span class="s2">&quot;lzr&quot;</span><span class="p">,</span>
                         <span class="n">edge_vmax</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">edge_vmin</span><span class="o">=-</span><span class="mf">.5</span><span class="p">)</span>
<span class="n">plot_matrices</span><span class="p">(</span><span class="n">gsc</span><span class="o">.</span><span class="n">covariances_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
              <span class="n">gsc</span><span class="o">.</span><span class="n">precisions_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">title</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ICA_Nilearn_dep_32_0.png" src="_images/ICA_Nilearn_dep_32_0.png" />
<img alt="_images/ICA_Nilearn_dep_32_1.png" src="_images/ICA_Nilearn_dep_32_1.png" />
<img alt="_images/ICA_Nilearn_dep_32_2.png" src="_images/ICA_Nilearn_dep_32_2.png" />
<img alt="_images/ICA_Nilearn_dep_32_3.png" src="_images/ICA_Nilearn_dep_32_3.png" />
<img alt="_images/ICA_Nilearn_dep_32_4.png" src="_images/ICA_Nilearn_dep_32_4.png" />
<img alt="_images/ICA_Nilearn_dep_32_5.png" src="_images/ICA_Nilearn_dep_32_5.png" />
<img alt="_images/ICA_Nilearn_dep_32_6.png" src="_images/ICA_Nilearn_dep_32_6.png" />
</div>
</div>
<p>Saving the matrices.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">plotting</span>

<span class="c1">#1st matrix</span>
<span class="n">cov</span><span class="o">=</span><span class="n">gsc</span><span class="o">.</span><span class="n">covariances_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">title</span><span class="o">=</span><span class="s1">&#39;GroupSparseCovariance&#39;</span>
<span class="n">display</span><span class="o">=</span><span class="n">plotting</span><span class="o">.</span><span class="n">plot_matrix</span><span class="p">(</span><span class="n">cov</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plotting</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">bwr</span><span class="p">,</span>
                     <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> / covariance&quot;</span> <span class="o">%</span> <span class="n">title</span><span class="p">,</span>
                     <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="n">display</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;GSC_covariance_dep.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="c1"># 2nd matrix</span>
<span class="n">cov</span><span class="o">=</span><span class="n">gl</span><span class="o">.</span><span class="n">covariance_</span>
<span class="n">title</span><span class="o">=</span><span class="s1">&#39;GraphicLassoCV&#39;</span>
<span class="c1"># Display covariance matrix</span>
<span class="n">display</span><span class="o">=</span><span class="n">plotting</span><span class="o">.</span><span class="n">plot_matrix</span><span class="p">(</span><span class="n">cov</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plotting</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">bwr</span><span class="p">,</span>
                     <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> / covariance&quot;</span> <span class="o">%</span> <span class="n">title</span><span class="p">,</span>
                     <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="n">display</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;GL_covariances_dep.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ICA_Nilearn_dep_34_0.png" src="_images/ICA_Nilearn_dep_34_0.png" />
<img alt="_images/ICA_Nilearn_dep_34_1.png" src="_images/ICA_Nilearn_dep_34_1.png" />
</div>
</div>
<p>Saving the precision matrix.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prec</span> <span class="o">=</span> <span class="n">gsc</span><span class="o">.</span><span class="n">precisions_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="c1"># Put zeros on the diagonal, for graph clarity.</span>
<span class="n">size</span> <span class="o">=</span> <span class="n">prec</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">prec</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">)),</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">))]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">span</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">prec</span><span class="o">.</span><span class="n">min</span><span class="p">()),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">prec</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
<span class="n">title</span><span class="o">=</span><span class="s1">&#39;GSC&#39;</span>
<span class="c1"># Display precision matrix</span>
<span class="n">display</span><span class="o">=</span><span class="n">plotting</span><span class="o">.</span><span class="n">plot_matrix</span><span class="p">(</span><span class="n">prec</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plotting</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">bwr</span><span class="p">,</span>
                     <span class="n">vmin</span><span class="o">=-</span><span class="n">span</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">span</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> / precision&quot;</span> <span class="o">%</span> <span class="n">title</span><span class="p">,</span>
                     <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>

<span class="n">display</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;Precision_dep.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ICA_Nilearn_dep_36_0.png" src="_images/ICA_Nilearn_dep_36_0.png" />
</div>
</div>
<p>Matrices are nice to see but we look also for the exactly figures and saving the as .csv file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">openpyxl</span>
<span class="n">df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">gl</span><span class="o">.</span><span class="n">covariance_</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;GL_covariances_dep.csv&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;GL_covariances_depx.xlsx&#39;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>L Aud</th>
      <th>R Aud</th>
      <th>Striate</th>
      <th>L DMN</th>
      <th>Med DMN</th>
      <th>Front DMN</th>
      <th>R DMN</th>
      <th>Occ post</th>
      <th>Motor</th>
      <th>R DLPFC</th>
      <th>...</th>
      <th>Sup Front S</th>
      <th>R TPJ</th>
      <th>R Pars Op</th>
      <th>Cereb</th>
      <th>Dors PCC</th>
      <th>L Ins</th>
      <th>Cing</th>
      <th>R Ins</th>
      <th>L Ant IPS</th>
      <th>R Ant IPS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>L Aud</th>
      <td>1.000000</td>
      <td>0.798597</td>
      <td>0.311369</td>
      <td>0.020126</td>
      <td>0.028022</td>
      <td>0.080498</td>
      <td>0.014081</td>
      <td>-0.008403</td>
      <td>0.481041</td>
      <td>0.129070</td>
      <td>...</td>
      <td>0.131533</td>
      <td>0.118058</td>
      <td>0.033434</td>
      <td>0.058716</td>
      <td>0.141267</td>
      <td>0.205152</td>
      <td>0.328673</td>
      <td>0.176284</td>
      <td>0.377998</td>
      <td>0.408313</td>
    </tr>
    <tr>
      <th>R Aud</th>
      <td>0.798597</td>
      <td>1.000000</td>
      <td>0.318436</td>
      <td>0.035964</td>
      <td>0.036390</td>
      <td>0.105700</td>
      <td>0.024445</td>
      <td>-0.006301</td>
      <td>0.487947</td>
      <td>0.119610</td>
      <td>...</td>
      <td>0.139515</td>
      <td>0.109687</td>
      <td>0.033385</td>
      <td>0.061050</td>
      <td>0.115625</td>
      <td>0.218479</td>
      <td>0.338444</td>
      <td>0.190555</td>
      <td>0.317715</td>
      <td>0.373012</td>
    </tr>
    <tr>
      <th>Striate</th>
      <td>0.311369</td>
      <td>0.318436</td>
      <td>1.000000</td>
      <td>0.074828</td>
      <td>0.172708</td>
      <td>0.096119</td>
      <td>0.094376</td>
      <td>-0.152740</td>
      <td>0.343312</td>
      <td>0.080067</td>
      <td>...</td>
      <td>0.102034</td>
      <td>0.132433</td>
      <td>0.050808</td>
      <td>0.122955</td>
      <td>0.152385</td>
      <td>0.119196</td>
      <td>0.145038</td>
      <td>0.105493</td>
      <td>0.162783</td>
      <td>0.202406</td>
    </tr>
    <tr>
      <th>L DMN</th>
      <td>0.020126</td>
      <td>0.035964</td>
      <td>0.074828</td>
      <td>1.000000</td>
      <td>0.525256</td>
      <td>0.360829</td>
      <td>0.562377</td>
      <td>0.040643</td>
      <td>0.026517</td>
      <td>0.172771</td>
      <td>...</td>
      <td>0.194160</td>
      <td>0.018377</td>
      <td>-0.009607</td>
      <td>-0.054098</td>
      <td>0.024442</td>
      <td>-0.176804</td>
      <td>-0.119470</td>
      <td>-0.210249</td>
      <td>-0.121566</td>
      <td>-0.130641</td>
    </tr>
    <tr>
      <th>Med DMN</th>
      <td>0.028022</td>
      <td>0.036390</td>
      <td>0.172708</td>
      <td>0.525256</td>
      <td>1.000000</td>
      <td>0.372645</td>
      <td>0.507807</td>
      <td>-0.024333</td>
      <td>0.046650</td>
      <td>0.261306</td>
      <td>...</td>
      <td>0.140689</td>
      <td>0.090776</td>
      <td>0.002580</td>
      <td>-0.017239</td>
      <td>0.247423</td>
      <td>-0.071507</td>
      <td>-0.055468</td>
      <td>-0.082465</td>
      <td>-0.070908</td>
      <td>-0.079136</td>
    </tr>
    <tr>
      <th>Front DMN</th>
      <td>0.080498</td>
      <td>0.105700</td>
      <td>0.096119</td>
      <td>0.360829</td>
      <td>0.372645</td>
      <td>1.000000</td>
      <td>0.357647</td>
      <td>0.079602</td>
      <td>0.125842</td>
      <td>0.212227</td>
      <td>...</td>
      <td>0.280557</td>
      <td>0.149762</td>
      <td>0.163063</td>
      <td>0.006443</td>
      <td>0.038734</td>
      <td>0.028853</td>
      <td>-0.020334</td>
      <td>0.014629</td>
      <td>-0.053709</td>
      <td>-0.042095</td>
    </tr>
    <tr>
      <th>R DMN</th>
      <td>0.014081</td>
      <td>0.024445</td>
      <td>0.094376</td>
      <td>0.562377</td>
      <td>0.507807</td>
      <td>0.357647</td>
      <td>1.000000</td>
      <td>0.032644</td>
      <td>0.031379</td>
      <td>0.313588</td>
      <td>...</td>
      <td>0.164104</td>
      <td>0.089041</td>
      <td>0.084598</td>
      <td>-0.030214</td>
      <td>0.148575</td>
      <td>-0.126284</td>
      <td>-0.088196</td>
      <td>-0.148346</td>
      <td>-0.087649</td>
      <td>-0.143642</td>
    </tr>
    <tr>
      <th>Occ post</th>
      <td>-0.008403</td>
      <td>-0.006301</td>
      <td>-0.152740</td>
      <td>0.040643</td>
      <td>-0.024333</td>
      <td>0.079602</td>
      <td>0.032644</td>
      <td>1.000000</td>
      <td>-0.030538</td>
      <td>0.114311</td>
      <td>...</td>
      <td>0.080393</td>
      <td>-0.004935</td>
      <td>0.071089</td>
      <td>0.059607</td>
      <td>-0.082976</td>
      <td>-0.019324</td>
      <td>0.005654</td>
      <td>-0.011347</td>
      <td>-0.018482</td>
      <td>-0.017379</td>
    </tr>
    <tr>
      <th>Motor</th>
      <td>0.481041</td>
      <td>0.487947</td>
      <td>0.343312</td>
      <td>0.026517</td>
      <td>0.046650</td>
      <td>0.125842</td>
      <td>0.031379</td>
      <td>-0.030538</td>
      <td>1.000000</td>
      <td>0.149832</td>
      <td>...</td>
      <td>0.216382</td>
      <td>0.179939</td>
      <td>0.093055</td>
      <td>0.109373</td>
      <td>0.268521</td>
      <td>0.182224</td>
      <td>0.293455</td>
      <td>0.147676</td>
      <td>0.353831</td>
      <td>0.432115</td>
    </tr>
    <tr>
      <th>R DLPFC</th>
      <td>0.129070</td>
      <td>0.119610</td>
      <td>0.080067</td>
      <td>0.172771</td>
      <td>0.261306</td>
      <td>0.212227</td>
      <td>0.313588</td>
      <td>0.114311</td>
      <td>0.149832</td>
      <td>1.000000</td>
      <td>...</td>
      <td>0.318859</td>
      <td>0.245616</td>
      <td>0.365569</td>
      <td>0.091681</td>
      <td>0.302731</td>
      <td>0.163989</td>
      <td>0.135900</td>
      <td>0.245253</td>
      <td>0.209637</td>
      <td>0.173442</td>
    </tr>
    <tr>
      <th>R Front pol</th>
      <td>-0.002424</td>
      <td>-0.013875</td>
      <td>-0.011285</td>
      <td>-0.008662</td>
      <td>0.035550</td>
      <td>0.063108</td>
      <td>0.044793</td>
      <td>0.096669</td>
      <td>0.016613</td>
      <td>0.437322</td>
      <td>...</td>
      <td>0.133519</td>
      <td>0.143582</td>
      <td>0.305217</td>
      <td>0.191062</td>
      <td>0.168530</td>
      <td>0.101328</td>
      <td>0.018442</td>
      <td>0.217209</td>
      <td>0.121655</td>
      <td>0.103794</td>
    </tr>
    <tr>
      <th>R Par</th>
      <td>0.009873</td>
      <td>-0.018478</td>
      <td>-0.033008</td>
      <td>0.131301</td>
      <td>0.262080</td>
      <td>0.106186</td>
      <td>0.190255</td>
      <td>0.059839</td>
      <td>0.034402</td>
      <td>0.635029</td>
      <td>...</td>
      <td>0.173915</td>
      <td>0.144199</td>
      <td>0.243112</td>
      <td>0.056155</td>
      <td>0.305637</td>
      <td>0.101919</td>
      <td>0.083725</td>
      <td>0.192449</td>
      <td>0.204593</td>
      <td>0.173509</td>
    </tr>
    <tr>
      <th>R Post Temp</th>
      <td>0.000963</td>
      <td>-0.011012</td>
      <td>-0.032770</td>
      <td>0.067480</td>
      <td>0.112701</td>
      <td>0.108624</td>
      <td>0.113081</td>
      <td>0.032464</td>
      <td>0.055431</td>
      <td>0.310932</td>
      <td>...</td>
      <td>0.140507</td>
      <td>0.237229</td>
      <td>0.193380</td>
      <td>0.034220</td>
      <td>0.127421</td>
      <td>0.007685</td>
      <td>-0.041414</td>
      <td>0.041618</td>
      <td>0.090684</td>
      <td>0.043872</td>
    </tr>
    <tr>
      <th>Basal</th>
      <td>0.188347</td>
      <td>0.204100</td>
      <td>0.128524</td>
      <td>0.000983</td>
      <td>0.089468</td>
      <td>0.175734</td>
      <td>0.040768</td>
      <td>0.130811</td>
      <td>0.206887</td>
      <td>0.247885</td>
      <td>...</td>
      <td>0.250573</td>
      <td>0.246880</td>
      <td>0.269575</td>
      <td>0.278554</td>
      <td>0.202774</td>
      <td>0.387134</td>
      <td>0.366277</td>
      <td>0.403311</td>
      <td>0.229568</td>
      <td>0.213024</td>
    </tr>
    <tr>
      <th>L Par</th>
      <td>0.021386</td>
      <td>0.009374</td>
      <td>-0.030529</td>
      <td>0.212918</td>
      <td>0.280419</td>
      <td>0.111897</td>
      <td>0.169365</td>
      <td>0.053906</td>
      <td>0.063949</td>
      <td>0.450854</td>
      <td>...</td>
      <td>0.248934</td>
      <td>0.146254</td>
      <td>0.165645</td>
      <td>0.047072</td>
      <td>0.258408</td>
      <td>0.060465</td>
      <td>0.032503</td>
      <td>0.067583</td>
      <td>0.162748</td>
      <td>0.092639</td>
    </tr>
    <tr>
      <th>L DLPFC</th>
      <td>0.201506</td>
      <td>0.203841</td>
      <td>0.111175</td>
      <td>0.360256</td>
      <td>0.283243</td>
      <td>0.231972</td>
      <td>0.273361</td>
      <td>0.124475</td>
      <td>0.210471</td>
      <td>0.550828</td>
      <td>...</td>
      <td>0.450700</td>
      <td>0.217148</td>
      <td>0.201206</td>
      <td>0.057364</td>
      <td>0.208246</td>
      <td>0.128819</td>
      <td>0.116437</td>
      <td>0.074251</td>
      <td>0.188292</td>
      <td>0.143131</td>
    </tr>
    <tr>
      <th>L Front pol</th>
      <td>0.031527</td>
      <td>0.022260</td>
      <td>-0.035416</td>
      <td>0.084417</td>
      <td>0.030373</td>
      <td>0.051433</td>
      <td>0.030772</td>
      <td>0.092785</td>
      <td>0.055483</td>
      <td>0.312285</td>
      <td>...</td>
      <td>0.188243</td>
      <td>0.083025</td>
      <td>0.171938</td>
      <td>0.158504</td>
      <td>0.110406</td>
      <td>0.035140</td>
      <td>-0.020470</td>
      <td>0.042398</td>
      <td>0.119325</td>
      <td>0.097118</td>
    </tr>
    <tr>
      <th>L IPS</th>
      <td>0.185165</td>
      <td>0.164383</td>
      <td>0.180191</td>
      <td>0.005084</td>
      <td>0.086607</td>
      <td>-0.074723</td>
      <td>-0.029153</td>
      <td>0.001486</td>
      <td>0.240558</td>
      <td>0.178378</td>
      <td>...</td>
      <td>0.019506</td>
      <td>0.037326</td>
      <td>-0.002639</td>
      <td>0.066958</td>
      <td>0.217480</td>
      <td>0.082361</td>
      <td>0.107520</td>
      <td>0.056572</td>
      <td>0.229100</td>
      <td>0.207472</td>
    </tr>
    <tr>
      <th>R IPS</th>
      <td>0.165305</td>
      <td>0.135577</td>
      <td>0.161794</td>
      <td>-0.067367</td>
      <td>0.063958</td>
      <td>-0.091728</td>
      <td>-0.027232</td>
      <td>-0.003194</td>
      <td>0.220118</td>
      <td>0.196049</td>
      <td>...</td>
      <td>-0.026182</td>
      <td>0.029117</td>
      <td>-0.001290</td>
      <td>0.079512</td>
      <td>0.234178</td>
      <td>0.062807</td>
      <td>0.103469</td>
      <td>0.061519</td>
      <td>0.216528</td>
      <td>0.202647</td>
    </tr>
    <tr>
      <th>L LOC</th>
      <td>0.277597</td>
      <td>0.260829</td>
      <td>0.380594</td>
      <td>0.001764</td>
      <td>0.007388</td>
      <td>0.040340</td>
      <td>-0.002785</td>
      <td>0.018587</td>
      <td>0.340349</td>
      <td>0.039068</td>
      <td>...</td>
      <td>0.084785</td>
      <td>0.093479</td>
      <td>0.031734</td>
      <td>0.111617</td>
      <td>0.128475</td>
      <td>0.087088</td>
      <td>0.146833</td>
      <td>0.100015</td>
      <td>0.188375</td>
      <td>0.269810</td>
    </tr>
    <tr>
      <th>Vis</th>
      <td>0.163318</td>
      <td>0.158736</td>
      <td>0.354828</td>
      <td>-0.080237</td>
      <td>-0.033009</td>
      <td>-0.010577</td>
      <td>-0.079339</td>
      <td>0.054932</td>
      <td>0.206028</td>
      <td>0.013075</td>
      <td>...</td>
      <td>0.055520</td>
      <td>0.118190</td>
      <td>0.101887</td>
      <td>0.272238</td>
      <td>0.088673</td>
      <td>0.117360</td>
      <td>0.091374</td>
      <td>0.135195</td>
      <td>0.123866</td>
      <td>0.168889</td>
    </tr>
    <tr>
      <th>R LOC</th>
      <td>0.269922</td>
      <td>0.259668</td>
      <td>0.394939</td>
      <td>-0.017008</td>
      <td>-0.012484</td>
      <td>0.048469</td>
      <td>-0.025506</td>
      <td>0.069904</td>
      <td>0.343112</td>
      <td>0.007009</td>
      <td>...</td>
      <td>0.118305</td>
      <td>0.118389</td>
      <td>0.040194</td>
      <td>0.173486</td>
      <td>0.115345</td>
      <td>0.115233</td>
      <td>0.130180</td>
      <td>0.103598</td>
      <td>0.188575</td>
      <td>0.269044</td>
    </tr>
    <tr>
      <th>D ACC</th>
      <td>0.162435</td>
      <td>0.167618</td>
      <td>0.125581</td>
      <td>0.030385</td>
      <td>0.121978</td>
      <td>0.210403</td>
      <td>0.073211</td>
      <td>0.050891</td>
      <td>0.167489</td>
      <td>0.343111</td>
      <td>...</td>
      <td>0.323766</td>
      <td>0.251532</td>
      <td>0.225271</td>
      <td>0.182462</td>
      <td>0.346686</td>
      <td>0.465754</td>
      <td>0.311057</td>
      <td>0.426074</td>
      <td>0.253865</td>
      <td>0.223102</td>
    </tr>
    <tr>
      <th>V ACC</th>
      <td>0.095895</td>
      <td>0.119517</td>
      <td>0.106695</td>
      <td>0.038231</td>
      <td>0.176077</td>
      <td>0.392223</td>
      <td>0.092831</td>
      <td>0.048847</td>
      <td>0.127050</td>
      <td>0.297167</td>
      <td>...</td>
      <td>0.293455</td>
      <td>0.233539</td>
      <td>0.254504</td>
      <td>0.082891</td>
      <td>0.217772</td>
      <td>0.422076</td>
      <td>0.251553</td>
      <td>0.433750</td>
      <td>0.152330</td>
      <td>0.128868</td>
    </tr>
    <tr>
      <th>R A Ins</th>
      <td>0.116683</td>
      <td>0.118783</td>
      <td>0.105140</td>
      <td>-0.023760</td>
      <td>0.120815</td>
      <td>0.217761</td>
      <td>0.096615</td>
      <td>0.051390</td>
      <td>0.112283</td>
      <td>0.479629</td>
      <td>...</td>
      <td>0.224791</td>
      <td>0.257888</td>
      <td>0.298713</td>
      <td>0.180664</td>
      <td>0.332027</td>
      <td>0.412633</td>
      <td>0.273798</td>
      <td>0.490279</td>
      <td>0.220605</td>
      <td>0.201504</td>
    </tr>
    <tr>
      <th>L STS</th>
      <td>0.420940</td>
      <td>0.425008</td>
      <td>0.278273</td>
      <td>-0.118531</td>
      <td>-0.006755</td>
      <td>0.048251</td>
      <td>-0.062866</td>
      <td>-0.016457</td>
      <td>0.386312</td>
      <td>0.158103</td>
      <td>...</td>
      <td>0.144132</td>
      <td>0.275751</td>
      <td>0.244301</td>
      <td>0.176389</td>
      <td>0.218191</td>
      <td>0.455217</td>
      <td>0.520989</td>
      <td>0.466484</td>
      <td>0.399777</td>
      <td>0.408984</td>
    </tr>
    <tr>
      <th>R STS</th>
      <td>0.331373</td>
      <td>0.343093</td>
      <td>0.235100</td>
      <td>-0.102695</td>
      <td>0.014773</td>
      <td>0.049121</td>
      <td>-0.071512</td>
      <td>-0.016333</td>
      <td>0.334791</td>
      <td>0.124987</td>
      <td>...</td>
      <td>0.134600</td>
      <td>0.281871</td>
      <td>0.226321</td>
      <td>0.182855</td>
      <td>0.217154</td>
      <td>0.463480</td>
      <td>0.522587</td>
      <td>0.451753</td>
      <td>0.362609</td>
      <td>0.379181</td>
    </tr>
    <tr>
      <th>L TPJ</th>
      <td>0.178542</td>
      <td>0.179749</td>
      <td>0.162304</td>
      <td>0.181114</td>
      <td>0.207464</td>
      <td>0.211637</td>
      <td>0.214557</td>
      <td>0.046078</td>
      <td>0.229466</td>
      <td>0.338435</td>
      <td>...</td>
      <td>0.443766</td>
      <td>0.520544</td>
      <td>0.399545</td>
      <td>0.112344</td>
      <td>0.177745</td>
      <td>0.248260</td>
      <td>0.200198</td>
      <td>0.234874</td>
      <td>0.146262</td>
      <td>0.148283</td>
    </tr>
    <tr>
      <th>Broca</th>
      <td>0.114794</td>
      <td>0.131615</td>
      <td>0.074836</td>
      <td>0.070911</td>
      <td>-0.020645</td>
      <td>0.153865</td>
      <td>0.038102</td>
      <td>0.087843</td>
      <td>0.150929</td>
      <td>0.201588</td>
      <td>...</td>
      <td>0.465485</td>
      <td>0.355914</td>
      <td>0.563253</td>
      <td>0.200372</td>
      <td>-0.009713</td>
      <td>0.321113</td>
      <td>0.151274</td>
      <td>0.264425</td>
      <td>0.099886</td>
      <td>0.101953</td>
    </tr>
    <tr>
      <th>Sup Front S</th>
      <td>0.131533</td>
      <td>0.139515</td>
      <td>0.102034</td>
      <td>0.194160</td>
      <td>0.140689</td>
      <td>0.280557</td>
      <td>0.164104</td>
      <td>0.080393</td>
      <td>0.216382</td>
      <td>0.318859</td>
      <td>...</td>
      <td>1.000000</td>
      <td>0.305614</td>
      <td>0.348074</td>
      <td>0.110502</td>
      <td>0.122262</td>
      <td>0.245523</td>
      <td>0.236595</td>
      <td>0.178675</td>
      <td>0.084309</td>
      <td>0.099080</td>
    </tr>
    <tr>
      <th>R TPJ</th>
      <td>0.118058</td>
      <td>0.109687</td>
      <td>0.132433</td>
      <td>0.018377</td>
      <td>0.090776</td>
      <td>0.149762</td>
      <td>0.089041</td>
      <td>-0.004935</td>
      <td>0.179939</td>
      <td>0.245616</td>
      <td>...</td>
      <td>0.305614</td>
      <td>1.000000</td>
      <td>0.422545</td>
      <td>0.119391</td>
      <td>0.139124</td>
      <td>0.257767</td>
      <td>0.141448</td>
      <td>0.271278</td>
      <td>0.101372</td>
      <td>0.117345</td>
    </tr>
    <tr>
      <th>R Pars Op</th>
      <td>0.033434</td>
      <td>0.033385</td>
      <td>0.050808</td>
      <td>-0.009607</td>
      <td>0.002580</td>
      <td>0.163063</td>
      <td>0.084598</td>
      <td>0.071089</td>
      <td>0.093055</td>
      <td>0.365569</td>
      <td>...</td>
      <td>0.348074</td>
      <td>0.422545</td>
      <td>1.000000</td>
      <td>0.186401</td>
      <td>0.104934</td>
      <td>0.357218</td>
      <td>0.181936</td>
      <td>0.464022</td>
      <td>0.117982</td>
      <td>0.117426</td>
    </tr>
    <tr>
      <th>Cereb</th>
      <td>0.058716</td>
      <td>0.061050</td>
      <td>0.122955</td>
      <td>-0.054098</td>
      <td>-0.017239</td>
      <td>0.006443</td>
      <td>-0.030214</td>
      <td>0.059607</td>
      <td>0.109373</td>
      <td>0.091681</td>
      <td>...</td>
      <td>0.110502</td>
      <td>0.119391</td>
      <td>0.186401</td>
      <td>1.000000</td>
      <td>0.119970</td>
      <td>0.165217</td>
      <td>0.149422</td>
      <td>0.168855</td>
      <td>0.110476</td>
      <td>0.117274</td>
    </tr>
    <tr>
      <th>Dors PCC</th>
      <td>0.141267</td>
      <td>0.115625</td>
      <td>0.152385</td>
      <td>0.024442</td>
      <td>0.247423</td>
      <td>0.038734</td>
      <td>0.148575</td>
      <td>-0.082976</td>
      <td>0.268521</td>
      <td>0.302731</td>
      <td>...</td>
      <td>0.122262</td>
      <td>0.139124</td>
      <td>0.104934</td>
      <td>0.119970</td>
      <td>1.000000</td>
      <td>0.199116</td>
      <td>0.239472</td>
      <td>0.205233</td>
      <td>0.317325</td>
      <td>0.271135</td>
    </tr>
    <tr>
      <th>L Ins</th>
      <td>0.205152</td>
      <td>0.218479</td>
      <td>0.119196</td>
      <td>-0.176804</td>
      <td>-0.071507</td>
      <td>0.028853</td>
      <td>-0.126284</td>
      <td>-0.019324</td>
      <td>0.182224</td>
      <td>0.163989</td>
      <td>...</td>
      <td>0.245523</td>
      <td>0.257767</td>
      <td>0.357218</td>
      <td>0.165217</td>
      <td>0.199116</td>
      <td>1.000000</td>
      <td>0.512821</td>
      <td>0.735890</td>
      <td>0.318274</td>
      <td>0.295043</td>
    </tr>
    <tr>
      <th>Cing</th>
      <td>0.328673</td>
      <td>0.338444</td>
      <td>0.145038</td>
      <td>-0.119470</td>
      <td>-0.055468</td>
      <td>-0.020334</td>
      <td>-0.088196</td>
      <td>0.005654</td>
      <td>0.293455</td>
      <td>0.135900</td>
      <td>...</td>
      <td>0.236595</td>
      <td>0.141448</td>
      <td>0.181936</td>
      <td>0.149422</td>
      <td>0.239472</td>
      <td>0.512821</td>
      <td>1.000000</td>
      <td>0.489152</td>
      <td>0.368348</td>
      <td>0.373027</td>
    </tr>
    <tr>
      <th>R Ins</th>
      <td>0.176284</td>
      <td>0.190555</td>
      <td>0.105493</td>
      <td>-0.210249</td>
      <td>-0.082465</td>
      <td>0.014629</td>
      <td>-0.148346</td>
      <td>-0.011347</td>
      <td>0.147676</td>
      <td>0.245253</td>
      <td>...</td>
      <td>0.178675</td>
      <td>0.271278</td>
      <td>0.464022</td>
      <td>0.168855</td>
      <td>0.205233</td>
      <td>0.735890</td>
      <td>0.489152</td>
      <td>1.000000</td>
      <td>0.308422</td>
      <td>0.313891</td>
    </tr>
    <tr>
      <th>L Ant IPS</th>
      <td>0.377998</td>
      <td>0.317715</td>
      <td>0.162783</td>
      <td>-0.121566</td>
      <td>-0.070908</td>
      <td>-0.053709</td>
      <td>-0.087649</td>
      <td>-0.018482</td>
      <td>0.353831</td>
      <td>0.209637</td>
      <td>...</td>
      <td>0.084309</td>
      <td>0.101372</td>
      <td>0.117982</td>
      <td>0.110476</td>
      <td>0.317325</td>
      <td>0.318274</td>
      <td>0.368348</td>
      <td>0.308422</td>
      <td>1.000000</td>
      <td>0.691629</td>
    </tr>
    <tr>
      <th>R Ant IPS</th>
      <td>0.408313</td>
      <td>0.373012</td>
      <td>0.202406</td>
      <td>-0.130641</td>
      <td>-0.079136</td>
      <td>-0.042095</td>
      <td>-0.143642</td>
      <td>-0.017379</td>
      <td>0.432115</td>
      <td>0.173442</td>
      <td>...</td>
      <td>0.099080</td>
      <td>0.117345</td>
      <td>0.117426</td>
      <td>0.117274</td>
      <td>0.271135</td>
      <td>0.295043</td>
      <td>0.373027</td>
      <td>0.313891</td>
      <td>0.691629</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
<p>39 rows × 39 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">gsc</span><span class="o">.</span><span class="n">covariances_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;GSC_covariances_dep.csv&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;GSC_covariances_depx.xlsx&#39;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>L Aud</th>
      <th>R Aud</th>
      <th>Striate</th>
      <th>L DMN</th>
      <th>Med DMN</th>
      <th>Front DMN</th>
      <th>R DMN</th>
      <th>Occ post</th>
      <th>Motor</th>
      <th>R DLPFC</th>
      <th>...</th>
      <th>Sup Front S</th>
      <th>R TPJ</th>
      <th>R Pars Op</th>
      <th>Cereb</th>
      <th>Dors PCC</th>
      <th>L Ins</th>
      <th>Cing</th>
      <th>R Ins</th>
      <th>L Ant IPS</th>
      <th>R Ant IPS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>L Aud</th>
      <td>1.000000</td>
      <td>0.723993</td>
      <td>0.335534</td>
      <td>-0.391873</td>
      <td>-0.266693</td>
      <td>0.159144</td>
      <td>-0.161126</td>
      <td>0.318132</td>
      <td>0.615321</td>
      <td>0.316602</td>
      <td>...</td>
      <td>0.362924</td>
      <td>0.242860</td>
      <td>0.203172</td>
      <td>0.239224</td>
      <td>0.389446</td>
      <td>0.330741</td>
      <td>0.726887</td>
      <td>0.473729</td>
      <td>0.582107</td>
      <td>0.597644</td>
    </tr>
    <tr>
      <th>R Aud</th>
      <td>0.723993</td>
      <td>1.000000</td>
      <td>0.258816</td>
      <td>-0.124548</td>
      <td>-0.152426</td>
      <td>0.158846</td>
      <td>-0.184140</td>
      <td>0.270117</td>
      <td>0.470894</td>
      <td>0.390148</td>
      <td>...</td>
      <td>0.364295</td>
      <td>0.081725</td>
      <td>0.128765</td>
      <td>0.285067</td>
      <td>0.252798</td>
      <td>0.274887</td>
      <td>0.689287</td>
      <td>0.383565</td>
      <td>0.446432</td>
      <td>0.555875</td>
    </tr>
    <tr>
      <th>Striate</th>
      <td>0.335534</td>
      <td>0.258816</td>
      <td>1.000000</td>
      <td>-0.100689</td>
      <td>0.179182</td>
      <td>0.370991</td>
      <td>-0.207750</td>
      <td>0.460856</td>
      <td>0.534865</td>
      <td>0.127694</td>
      <td>...</td>
      <td>0.348141</td>
      <td>0.071062</td>
      <td>-0.002886</td>
      <td>0.347878</td>
      <td>-0.002718</td>
      <td>0.257796</td>
      <td>0.372401</td>
      <td>0.368429</td>
      <td>0.331933</td>
      <td>0.376441</td>
    </tr>
    <tr>
      <th>L DMN</th>
      <td>-0.391873</td>
      <td>-0.124548</td>
      <td>-0.100689</td>
      <td>1.000000</td>
      <td>0.402709</td>
      <td>-0.054991</td>
      <td>0.164837</td>
      <td>-0.274704</td>
      <td>-0.346026</td>
      <td>-0.002294</td>
      <td>...</td>
      <td>0.039678</td>
      <td>-0.130282</td>
      <td>-0.077344</td>
      <td>0.128919</td>
      <td>-0.312697</td>
      <td>-0.056373</td>
      <td>-0.403098</td>
      <td>-0.291883</td>
      <td>-0.335421</td>
      <td>-0.230883</td>
    </tr>
    <tr>
      <th>Med DMN</th>
      <td>-0.266693</td>
      <td>-0.152426</td>
      <td>0.179182</td>
      <td>0.402709</td>
      <td>1.000000</td>
      <td>0.108623</td>
      <td>0.287465</td>
      <td>-0.155881</td>
      <td>-0.039888</td>
      <td>0.003539</td>
      <td>...</td>
      <td>-0.034046</td>
      <td>-0.250336</td>
      <td>-0.047933</td>
      <td>0.065559</td>
      <td>-0.141205</td>
      <td>0.125765</td>
      <td>-0.191081</td>
      <td>0.109152</td>
      <td>-0.010307</td>
      <td>0.003584</td>
    </tr>
    <tr>
      <th>Front DMN</th>
      <td>0.159144</td>
      <td>0.158846</td>
      <td>0.370991</td>
      <td>-0.054991</td>
      <td>0.108623</td>
      <td>1.000000</td>
      <td>0.029732</td>
      <td>0.292180</td>
      <td>0.270184</td>
      <td>0.324467</td>
      <td>...</td>
      <td>0.149203</td>
      <td>-0.016972</td>
      <td>-0.093003</td>
      <td>0.022880</td>
      <td>-0.092625</td>
      <td>-0.041219</td>
      <td>0.190689</td>
      <td>0.127897</td>
      <td>0.021036</td>
      <td>0.068663</td>
    </tr>
    <tr>
      <th>R DMN</th>
      <td>-0.161126</td>
      <td>-0.184140</td>
      <td>-0.207750</td>
      <td>0.164837</td>
      <td>0.287465</td>
      <td>0.029732</td>
      <td>1.000000</td>
      <td>-0.237601</td>
      <td>-0.039638</td>
      <td>0.302177</td>
      <td>...</td>
      <td>-0.144307</td>
      <td>0.216180</td>
      <td>0.441628</td>
      <td>-0.269782</td>
      <td>0.241958</td>
      <td>0.068973</td>
      <td>-0.089262</td>
      <td>0.097530</td>
      <td>0.036577</td>
      <td>-0.232277</td>
    </tr>
    <tr>
      <th>Occ post</th>
      <td>0.318132</td>
      <td>0.270117</td>
      <td>0.460856</td>
      <td>-0.274704</td>
      <td>-0.155881</td>
      <td>0.292180</td>
      <td>-0.237601</td>
      <td>1.000000</td>
      <td>0.373314</td>
      <td>0.246340</td>
      <td>...</td>
      <td>0.344706</td>
      <td>0.289952</td>
      <td>0.167907</td>
      <td>0.094994</td>
      <td>0.017284</td>
      <td>0.112110</td>
      <td>0.350210</td>
      <td>0.167072</td>
      <td>0.058340</td>
      <td>0.176738</td>
    </tr>
    <tr>
      <th>Motor</th>
      <td>0.615321</td>
      <td>0.470894</td>
      <td>0.534865</td>
      <td>-0.346026</td>
      <td>-0.039888</td>
      <td>0.270184</td>
      <td>-0.039638</td>
      <td>0.373314</td>
      <td>1.000000</td>
      <td>0.436821</td>
      <td>...</td>
      <td>0.499459</td>
      <td>0.230056</td>
      <td>0.119525</td>
      <td>0.131572</td>
      <td>0.531655</td>
      <td>0.277823</td>
      <td>0.776233</td>
      <td>0.570483</td>
      <td>0.737922</td>
      <td>0.745511</td>
    </tr>
    <tr>
      <th>R DLPFC</th>
      <td>0.316602</td>
      <td>0.390148</td>
      <td>0.127694</td>
      <td>-0.002294</td>
      <td>0.003539</td>
      <td>0.324467</td>
      <td>0.302177</td>
      <td>0.246340</td>
      <td>0.436821</td>
      <td>1.000000</td>
      <td>...</td>
      <td>0.276209</td>
      <td>0.216335</td>
      <td>0.530285</td>
      <td>0.257033</td>
      <td>0.369421</td>
      <td>0.124911</td>
      <td>0.480172</td>
      <td>0.421895</td>
      <td>0.349252</td>
      <td>0.292561</td>
    </tr>
    <tr>
      <th>R Front pol</th>
      <td>0.049523</td>
      <td>0.245537</td>
      <td>0.158334</td>
      <td>-0.015173</td>
      <td>0.306456</td>
      <td>0.240384</td>
      <td>0.023282</td>
      <td>0.238644</td>
      <td>0.116828</td>
      <td>0.459396</td>
      <td>...</td>
      <td>0.125913</td>
      <td>0.065059</td>
      <td>0.393506</td>
      <td>0.089676</td>
      <td>0.068352</td>
      <td>0.049663</td>
      <td>0.140735</td>
      <td>0.337759</td>
      <td>0.152963</td>
      <td>0.121012</td>
    </tr>
    <tr>
      <th>R Par</th>
      <td>0.365313</td>
      <td>0.366905</td>
      <td>-0.016710</td>
      <td>-0.097160</td>
      <td>-0.015364</td>
      <td>-0.060162</td>
      <td>0.285397</td>
      <td>-0.003306</td>
      <td>0.458180</td>
      <td>0.684621</td>
      <td>...</td>
      <td>0.310920</td>
      <td>0.230587</td>
      <td>0.557294</td>
      <td>0.083893</td>
      <td>0.567973</td>
      <td>0.222191</td>
      <td>0.525569</td>
      <td>0.600843</td>
      <td>0.594764</td>
      <td>0.397167</td>
    </tr>
    <tr>
      <th>R Post Temp</th>
      <td>0.190881</td>
      <td>0.215962</td>
      <td>0.123250</td>
      <td>-0.007307</td>
      <td>0.251898</td>
      <td>0.167606</td>
      <td>0.032700</td>
      <td>0.023695</td>
      <td>0.347939</td>
      <td>0.255635</td>
      <td>...</td>
      <td>0.150743</td>
      <td>-0.203962</td>
      <td>-0.061742</td>
      <td>-0.086129</td>
      <td>0.276157</td>
      <td>0.054878</td>
      <td>0.383349</td>
      <td>0.308049</td>
      <td>0.431973</td>
      <td>0.354424</td>
    </tr>
    <tr>
      <th>Basal</th>
      <td>0.429863</td>
      <td>0.423924</td>
      <td>0.269270</td>
      <td>-0.123745</td>
      <td>0.022378</td>
      <td>0.077745</td>
      <td>0.167056</td>
      <td>0.194049</td>
      <td>0.583348</td>
      <td>0.441410</td>
      <td>...</td>
      <td>0.411660</td>
      <td>0.257569</td>
      <td>0.241231</td>
      <td>0.003288</td>
      <td>0.537567</td>
      <td>0.322775</td>
      <td>0.535961</td>
      <td>0.545196</td>
      <td>0.603621</td>
      <td>0.558929</td>
    </tr>
    <tr>
      <th>L Par</th>
      <td>0.242221</td>
      <td>0.399379</td>
      <td>-0.104040</td>
      <td>0.193146</td>
      <td>0.003272</td>
      <td>-0.087693</td>
      <td>0.095830</td>
      <td>-0.128530</td>
      <td>0.300385</td>
      <td>0.449526</td>
      <td>...</td>
      <td>0.472471</td>
      <td>0.177203</td>
      <td>0.288867</td>
      <td>0.254584</td>
      <td>0.361929</td>
      <td>0.186514</td>
      <td>0.354433</td>
      <td>0.353458</td>
      <td>0.431679</td>
      <td>0.348734</td>
    </tr>
    <tr>
      <th>L DLPFC</th>
      <td>0.120428</td>
      <td>0.366274</td>
      <td>0.151783</td>
      <td>0.478160</td>
      <td>0.016785</td>
      <td>0.164619</td>
      <td>-0.182490</td>
      <td>0.103437</td>
      <td>0.184286</td>
      <td>0.340764</td>
      <td>...</td>
      <td>0.371768</td>
      <td>0.136453</td>
      <td>-0.047105</td>
      <td>0.395028</td>
      <td>0.010888</td>
      <td>0.043558</td>
      <td>0.167629</td>
      <td>-0.029470</td>
      <td>0.055445</td>
      <td>0.257381</td>
    </tr>
    <tr>
      <th>L Front pol</th>
      <td>0.029674</td>
      <td>0.234701</td>
      <td>-0.080965</td>
      <td>0.402028</td>
      <td>-0.173958</td>
      <td>0.180350</td>
      <td>-0.065546</td>
      <td>-0.008426</td>
      <td>-0.053654</td>
      <td>0.266003</td>
      <td>...</td>
      <td>0.084001</td>
      <td>0.072517</td>
      <td>-0.050543</td>
      <td>0.195151</td>
      <td>-0.151275</td>
      <td>-0.179974</td>
      <td>0.013291</td>
      <td>-0.315742</td>
      <td>-0.172008</td>
      <td>-0.000594</td>
    </tr>
    <tr>
      <th>L IPS</th>
      <td>0.169463</td>
      <td>0.199122</td>
      <td>0.299818</td>
      <td>-0.013719</td>
      <td>0.066391</td>
      <td>0.134882</td>
      <td>-0.152996</td>
      <td>-0.021528</td>
      <td>0.382591</td>
      <td>-0.062871</td>
      <td>...</td>
      <td>0.306387</td>
      <td>0.016734</td>
      <td>-0.336912</td>
      <td>0.118395</td>
      <td>0.040044</td>
      <td>0.046451</td>
      <td>0.239145</td>
      <td>0.046899</td>
      <td>0.297401</td>
      <td>0.361101</td>
    </tr>
    <tr>
      <th>R IPS</th>
      <td>0.117088</td>
      <td>0.053976</td>
      <td>0.162174</td>
      <td>-0.337169</td>
      <td>0.155028</td>
      <td>0.255857</td>
      <td>0.036620</td>
      <td>0.039049</td>
      <td>0.335083</td>
      <td>0.075213</td>
      <td>...</td>
      <td>0.217105</td>
      <td>-0.139381</td>
      <td>-0.156527</td>
      <td>-0.069323</td>
      <td>0.108961</td>
      <td>0.044987</td>
      <td>0.275137</td>
      <td>0.226908</td>
      <td>0.289309</td>
      <td>0.149221</td>
    </tr>
    <tr>
      <th>L LOC</th>
      <td>0.402565</td>
      <td>0.320117</td>
      <td>0.524747</td>
      <td>-0.307442</td>
      <td>-0.012128</td>
      <td>0.076149</td>
      <td>-0.117833</td>
      <td>0.172029</td>
      <td>0.672230</td>
      <td>0.283406</td>
      <td>...</td>
      <td>0.403131</td>
      <td>0.157649</td>
      <td>0.063273</td>
      <td>0.289763</td>
      <td>0.465206</td>
      <td>0.298806</td>
      <td>0.510661</td>
      <td>0.487936</td>
      <td>0.667014</td>
      <td>0.605372</td>
    </tr>
    <tr>
      <th>Vis</th>
      <td>0.175704</td>
      <td>0.236847</td>
      <td>0.403510</td>
      <td>0.039363</td>
      <td>0.039708</td>
      <td>-0.088472</td>
      <td>-0.198282</td>
      <td>0.113618</td>
      <td>0.285367</td>
      <td>0.159819</td>
      <td>...</td>
      <td>0.321978</td>
      <td>-0.016503</td>
      <td>0.185184</td>
      <td>0.507036</td>
      <td>-0.031222</td>
      <td>0.335715</td>
      <td>0.249954</td>
      <td>0.396053</td>
      <td>0.266258</td>
      <td>0.198232</td>
    </tr>
    <tr>
      <th>R LOC</th>
      <td>0.465298</td>
      <td>0.364454</td>
      <td>0.655239</td>
      <td>-0.304061</td>
      <td>0.118796</td>
      <td>0.206834</td>
      <td>-0.274094</td>
      <td>0.386503</td>
      <td>0.633773</td>
      <td>0.080604</td>
      <td>...</td>
      <td>0.521493</td>
      <td>0.031064</td>
      <td>-0.018842</td>
      <td>0.236396</td>
      <td>0.094266</td>
      <td>0.346045</td>
      <td>0.502329</td>
      <td>0.499864</td>
      <td>0.541262</td>
      <td>0.515212</td>
    </tr>
    <tr>
      <th>D ACC</th>
      <td>0.384025</td>
      <td>0.397976</td>
      <td>0.334343</td>
      <td>-0.113546</td>
      <td>-0.042585</td>
      <td>0.229807</td>
      <td>-0.081055</td>
      <td>0.264923</td>
      <td>0.607251</td>
      <td>0.249474</td>
      <td>...</td>
      <td>0.538891</td>
      <td>0.308454</td>
      <td>0.080315</td>
      <td>0.050565</td>
      <td>0.368542</td>
      <td>0.382381</td>
      <td>0.415222</td>
      <td>0.489495</td>
      <td>0.513567</td>
      <td>0.552184</td>
    </tr>
    <tr>
      <th>V ACC</th>
      <td>0.334477</td>
      <td>0.182155</td>
      <td>0.445593</td>
      <td>-0.318788</td>
      <td>0.133247</td>
      <td>0.347258</td>
      <td>0.038941</td>
      <td>0.368969</td>
      <td>0.605187</td>
      <td>0.227399</td>
      <td>...</td>
      <td>0.556707</td>
      <td>0.243350</td>
      <td>0.128447</td>
      <td>-0.081586</td>
      <td>0.331741</td>
      <td>0.350323</td>
      <td>0.417691</td>
      <td>0.595412</td>
      <td>0.516982</td>
      <td>0.480074</td>
    </tr>
    <tr>
      <th>R A Ins</th>
      <td>0.482529</td>
      <td>0.445116</td>
      <td>0.326881</td>
      <td>-0.291555</td>
      <td>-0.000792</td>
      <td>0.352516</td>
      <td>0.101550</td>
      <td>0.373531</td>
      <td>0.551085</td>
      <td>0.546800</td>
      <td>...</td>
      <td>0.491504</td>
      <td>0.329609</td>
      <td>0.439311</td>
      <td>0.006843</td>
      <td>0.357359</td>
      <td>0.264846</td>
      <td>0.522388</td>
      <td>0.661731</td>
      <td>0.507428</td>
      <td>0.453865</td>
    </tr>
    <tr>
      <th>L STS</th>
      <td>0.593067</td>
      <td>0.439415</td>
      <td>0.520597</td>
      <td>-0.427618</td>
      <td>-0.122077</td>
      <td>0.205870</td>
      <td>-0.102779</td>
      <td>0.365405</td>
      <td>0.717865</td>
      <td>0.421519</td>
      <td>...</td>
      <td>0.246182</td>
      <td>0.218819</td>
      <td>0.249295</td>
      <td>0.349661</td>
      <td>0.469413</td>
      <td>0.303933</td>
      <td>0.614418</td>
      <td>0.525779</td>
      <td>0.631493</td>
      <td>0.580915</td>
    </tr>
    <tr>
      <th>R STS</th>
      <td>0.530024</td>
      <td>0.408987</td>
      <td>0.556244</td>
      <td>-0.427232</td>
      <td>-0.075839</td>
      <td>0.197978</td>
      <td>-0.154733</td>
      <td>0.413129</td>
      <td>0.754534</td>
      <td>0.370551</td>
      <td>...</td>
      <td>0.326620</td>
      <td>0.250453</td>
      <td>0.229706</td>
      <td>0.319156</td>
      <td>0.429435</td>
      <td>0.301279</td>
      <td>0.656655</td>
      <td>0.589782</td>
      <td>0.626649</td>
      <td>0.647171</td>
    </tr>
    <tr>
      <th>L TPJ</th>
      <td>0.318434</td>
      <td>0.295216</td>
      <td>0.190809</td>
      <td>-0.013349</td>
      <td>-0.025061</td>
      <td>0.002641</td>
      <td>0.148720</td>
      <td>0.265409</td>
      <td>0.446373</td>
      <td>0.399649</td>
      <td>...</td>
      <td>0.566440</td>
      <td>0.693813</td>
      <td>0.453716</td>
      <td>0.097893</td>
      <td>0.404807</td>
      <td>0.145749</td>
      <td>0.312676</td>
      <td>0.299736</td>
      <td>0.370368</td>
      <td>0.271565</td>
    </tr>
    <tr>
      <th>Broca</th>
      <td>-0.192379</td>
      <td>-0.073537</td>
      <td>0.049097</td>
      <td>0.412684</td>
      <td>0.003704</td>
      <td>-0.044705</td>
      <td>-0.094523</td>
      <td>0.190289</td>
      <td>-0.264723</td>
      <td>-0.095010</td>
      <td>...</td>
      <td>0.291984</td>
      <td>0.373802</td>
      <td>0.155824</td>
      <td>0.166062</td>
      <td>-0.293201</td>
      <td>0.059135</td>
      <td>-0.338791</td>
      <td>-0.270176</td>
      <td>-0.375172</td>
      <td>-0.302726</td>
    </tr>
    <tr>
      <th>Sup Front S</th>
      <td>0.362924</td>
      <td>0.364295</td>
      <td>0.348141</td>
      <td>0.039678</td>
      <td>-0.034046</td>
      <td>0.149203</td>
      <td>-0.144307</td>
      <td>0.344706</td>
      <td>0.499459</td>
      <td>0.276209</td>
      <td>...</td>
      <td>1.000000</td>
      <td>0.395983</td>
      <td>0.167171</td>
      <td>0.184154</td>
      <td>0.158178</td>
      <td>0.210378</td>
      <td>0.360390</td>
      <td>0.308485</td>
      <td>0.327649</td>
      <td>0.454188</td>
    </tr>
    <tr>
      <th>R TPJ</th>
      <td>0.242860</td>
      <td>0.081725</td>
      <td>0.071062</td>
      <td>-0.130282</td>
      <td>-0.250336</td>
      <td>-0.016972</td>
      <td>0.216180</td>
      <td>0.289952</td>
      <td>0.230056</td>
      <td>0.216335</td>
      <td>...</td>
      <td>0.395983</td>
      <td>1.000000</td>
      <td>0.492338</td>
      <td>-0.016286</td>
      <td>0.346553</td>
      <td>0.095345</td>
      <td>0.084928</td>
      <td>0.169089</td>
      <td>0.156912</td>
      <td>0.081668</td>
    </tr>
    <tr>
      <th>R Pars Op</th>
      <td>0.203172</td>
      <td>0.128765</td>
      <td>-0.002886</td>
      <td>-0.077344</td>
      <td>-0.047933</td>
      <td>-0.093003</td>
      <td>0.441628</td>
      <td>0.167907</td>
      <td>0.119525</td>
      <td>0.530285</td>
      <td>...</td>
      <td>0.167171</td>
      <td>0.492338</td>
      <td>1.000000</td>
      <td>0.056583</td>
      <td>0.282230</td>
      <td>0.210745</td>
      <td>0.160045</td>
      <td>0.417641</td>
      <td>0.163992</td>
      <td>-0.036347</td>
    </tr>
    <tr>
      <th>Cereb</th>
      <td>0.239224</td>
      <td>0.285067</td>
      <td>0.347878</td>
      <td>0.128919</td>
      <td>0.065559</td>
      <td>0.022880</td>
      <td>-0.269782</td>
      <td>0.094994</td>
      <td>0.131572</td>
      <td>0.257033</td>
      <td>...</td>
      <td>0.184154</td>
      <td>-0.016286</td>
      <td>0.056583</td>
      <td>1.000000</td>
      <td>-0.079858</td>
      <td>0.177932</td>
      <td>0.150955</td>
      <td>0.121277</td>
      <td>0.079782</td>
      <td>0.239999</td>
    </tr>
    <tr>
      <th>Dors PCC</th>
      <td>0.389446</td>
      <td>0.252798</td>
      <td>-0.002718</td>
      <td>-0.312697</td>
      <td>-0.141205</td>
      <td>-0.092625</td>
      <td>0.241958</td>
      <td>0.017284</td>
      <td>0.531655</td>
      <td>0.369421</td>
      <td>...</td>
      <td>0.158178</td>
      <td>0.346553</td>
      <td>0.282230</td>
      <td>-0.079858</td>
      <td>1.000000</td>
      <td>0.326032</td>
      <td>0.481217</td>
      <td>0.505795</td>
      <td>0.659255</td>
      <td>0.516132</td>
    </tr>
    <tr>
      <th>L Ins</th>
      <td>0.330741</td>
      <td>0.274887</td>
      <td>0.257796</td>
      <td>-0.056373</td>
      <td>0.125765</td>
      <td>-0.041219</td>
      <td>0.068973</td>
      <td>0.112110</td>
      <td>0.277823</td>
      <td>0.124911</td>
      <td>...</td>
      <td>0.210378</td>
      <td>0.095345</td>
      <td>0.210745</td>
      <td>0.177932</td>
      <td>0.326032</td>
      <td>1.000000</td>
      <td>0.288572</td>
      <td>0.608210</td>
      <td>0.425118</td>
      <td>0.299260</td>
    </tr>
    <tr>
      <th>Cing</th>
      <td>0.726887</td>
      <td>0.689287</td>
      <td>0.372401</td>
      <td>-0.403098</td>
      <td>-0.191081</td>
      <td>0.190689</td>
      <td>-0.089262</td>
      <td>0.350210</td>
      <td>0.776233</td>
      <td>0.480172</td>
      <td>...</td>
      <td>0.360390</td>
      <td>0.084928</td>
      <td>0.160045</td>
      <td>0.150955</td>
      <td>0.481217</td>
      <td>0.288572</td>
      <td>1.000000</td>
      <td>0.578067</td>
      <td>0.678811</td>
      <td>0.722117</td>
    </tr>
    <tr>
      <th>R Ins</th>
      <td>0.473729</td>
      <td>0.383565</td>
      <td>0.368429</td>
      <td>-0.291883</td>
      <td>0.109152</td>
      <td>0.127897</td>
      <td>0.097530</td>
      <td>0.167072</td>
      <td>0.570483</td>
      <td>0.421895</td>
      <td>...</td>
      <td>0.308485</td>
      <td>0.169089</td>
      <td>0.417641</td>
      <td>0.121277</td>
      <td>0.505795</td>
      <td>0.608210</td>
      <td>0.578067</td>
      <td>1.000000</td>
      <td>0.706094</td>
      <td>0.545425</td>
    </tr>
    <tr>
      <th>L Ant IPS</th>
      <td>0.582107</td>
      <td>0.446432</td>
      <td>0.331933</td>
      <td>-0.335421</td>
      <td>-0.010307</td>
      <td>0.021036</td>
      <td>0.036577</td>
      <td>0.058340</td>
      <td>0.737922</td>
      <td>0.349252</td>
      <td>...</td>
      <td>0.327649</td>
      <td>0.156912</td>
      <td>0.163992</td>
      <td>0.079782</td>
      <td>0.659255</td>
      <td>0.425118</td>
      <td>0.678811</td>
      <td>0.706094</td>
      <td>1.000000</td>
      <td>0.774519</td>
    </tr>
    <tr>
      <th>R Ant IPS</th>
      <td>0.597644</td>
      <td>0.555875</td>
      <td>0.376441</td>
      <td>-0.230883</td>
      <td>0.003584</td>
      <td>0.068663</td>
      <td>-0.232277</td>
      <td>0.176738</td>
      <td>0.745511</td>
      <td>0.292561</td>
      <td>...</td>
      <td>0.454188</td>
      <td>0.081668</td>
      <td>-0.036347</td>
      <td>0.239999</td>
      <td>0.516132</td>
      <td>0.299260</td>
      <td>0.722117</td>
      <td>0.545425</td>
      <td>0.774519</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
<p>39 rows × 39 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="nn">urllib.request</span>

<span class="n">URL</span> <span class="o">=</span> <span class="s1">&#39;https://st.depositphotos.com/1431107/1631/i/950/depositphotos_16317151-stock-photo-well-done-illustration.jpg&#39;</span>

<span class="k">with</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">URL</span><span class="p">)</span> <span class="k">as</span> <span class="n">url</span><span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;temp.jpg&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">url</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

<span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;temp.jpg&#39;</span><span class="p">)</span>

<span class="n">img</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="data_analyses.html" title="previous page">Data analyses</a>
    <a class='right-next' id="next-link" href="ICA_Nilearn_healthy.html" title="next page">Independet Component Analysis with Nilearn (healthy subjects)</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
            &copy; Copyright .<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>